<!DOCTYPE html>
<!--
    TIMELINE OF US - Interactive Romantic Slideshow
    
    This file contains ALL the code for the application:
    - HTML: Structure and content (slides, buttons, text)
    - CSS: Styling and animations (inside <style> tag)
    - JavaScript: Interactivity (inside <script> tag)
    
    No external files or frameworks needed!
-->
<html lang="en">
<head>
    <!-- Meta tags: Give browser information about the page -->
    <meta charset="UTF-8">  <!-- Character encoding for emoji/special characters -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  <!-- Makes it work on mobile -->
    <title>Our Love Timeline ‚ù§Ô∏è</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üíï</text></svg>">
    
    <!-- CSS STYLES: Everything inside <style> controls how things look -->
    <style>
        /* UNIVERSAL RESET: Remove default browser spacing */
        * {
            margin: 0;           /* Remove default margins */
            padding: 0;          /* Remove default padding */
            box-sizing: border-box;  /* Include padding in element size */
        }

        /* CSS VARIABLES: Define colors once, use everywhere */
        /* Use these with var(--variable-name) throughout CSS */
        :root {
            --primary-pink: #ff6b9d;      /* Main pink color */
            --secondary-pink: #ffc1cc;    /* Lighter pink for backgrounds */
            --accent-red: #ff1744;        /* Bright red for envelope/accents */
            --soft-white: #fff5f7;        /* Off-white with pink tint */
            --text-dark: #4a4a4a;         /* Dark gray for readable text */
        }

        /* BODY: Main container for entire page */
        body {
            font-family: 'Georgia', serif;  /* Elegant serif font */
            background: linear-gradient(135deg, var(--soft-white) 0%, var(--secondary-pink) 100%);  /* Gradient background */
            color: var(--text-dark);  /* Default text color */
            overflow: auto;  /* Allow scrolling if needed */
            height: 100vh;   /* Full viewport height (100% of screen) */
        }

        /* ============================================
           FLOATING HEARTS BACKGROUND DECORATION
           ============================================ */
        
        /* Container for all floating hearts */
        .heart-container {
            position: fixed;     /* Stays in place when scrolling */
            top: 0;
            left: 0;
            width: 100%;         /* Full screen width */
            height: 100%;        /* Full screen height */
            pointer-events: none;  /* Clicks pass through to content below */
            z-index: 1;          /* Layer behind content */
            overflow: hidden;    /* Hide hearts outside container */
        }

        /* Individual floating heart */
        .heart {
            position: absolute;  /* Can be positioned anywhere */
            font-size: 20px;
            opacity: 0;          /* Starts invisible */
            animation: float 8s infinite ease-in-out;  /* 8 second animation, repeats forever */
        }

        /* KEYFRAME ANIMATIONS: Define how elements move over time */
        
        /* Float animation: Hearts rise from bottom to top */
        @keyframes float {
            0% {    /* Start: Bottom of screen */
                transform: translateY(100vh) rotate(0deg);  /* Move down 100% viewport height */
                opacity: 0;   /* Invisible */
            }
            10% {   /* Fade in */
                opacity: 1;
            }
            90% {   /* Stay visible */
                opacity: 1;
            }
            100% {  /* End: Top of screen, rotated */
                transform: translateY(-100px) rotate(360deg);  /* Move up, full rotation */
                opacity: 0;   /* Fade out */
            }
        }
            50% {
                transform: scale(1) translateY(-100px) rotate(10deg);
                opacity: 1;
            }
            100% {
                transform: scale(0.8) translateY(-300px) rotate(25deg);
                opacity: 0;
            }
        }

        /* ============================================
           SLIDESHOW SYSTEM
           ============================================ */
        
        /* Main container holding all slides */
        .slideshow-container {
            position: relative;  /* Reference point for absolutely positioned slides */
            width: 100%;         /* Full width */
            height: 100vh;       /* Full viewport height */
            display: flex;       /* Use flexbox for centering */
            align-items: center;     /* Center vertically */
            justify-content: center; /* Center horizontally */
        }

        /* Individual slide (default/hidden state) */
        .slide {
            display: none;       /* Hidden by default */
            width: 100%;         /* Full width */
            min-height: 100vh;   /* At least full screen height */
            position: absolute;  /* Stack slides on top of each other */
            top: 0;
            left: 0;
            opacity: 0;          /* Invisible */
            visibility: hidden;  /* Completely hidden from screen readers too */
            transition: opacity 0.8s ease-in-out, transform 0.8s ease-in-out;  /* Smooth changes */
            padding-bottom: clamp(160px, 22vh, 220px);  /* Space at bottom for timeline */
        }

        /* Active slide (visible state) */
        .slide.active {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            opacity: 1;
            visibility: visible;
            z-index: 10;
        }

        /* Apply slide-in only when explicitly requested */
        .slide.slide-in-right {
            animation: slideInFromRight 0.6s cubic-bezier(.22,.9,.37,1) forwards;
        }

        .slide.slide-out-left {
            animation: slideOutLeft 0.6s cubic-bezier(.22,.9,.37,1) forwards;
        }

        .slide.slide-out-right {
            animation: slideOutRight 0.6s cubic-bezier(.22,.9,.37,1) forwards;
        }

        @keyframes slideOutLeft {
            from {
                opacity: 1;
                transform: translateX(0) scale(1);
            }
            to {
                opacity: 0;
                transform: translateX(-100px) scale(0.95);
            }
        }

        @keyframes slideOutRight {
            from {
                opacity: 1;
                transform: translateX(0) scale(1);
            }
            to {
                opacity: 0;
                transform: translateX(100px) scale(0.95);
            }
        }

        @keyframes slideInFromRight {
            from {
                opacity: 0;
                transform: translateX(100px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateX(0) scale(1);
            }
        }

        @keyframes fadeOut {
            from { opacity: 1; transform: none; }
            to { opacity: 0; transform: scale(0.98); }
        }

        /* Prevent default slide animation when we want pure fades */
        .slide.active.no-slide {
            animation: none !important;
        }

        /* End reveal animation (used when closing letter) */
        @keyframes endRevealIn {
            from { opacity: 0; transform: scale(0.96) translateY(20px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }
        .end-reveal-in {
            animation: endRevealIn 0.7s cubic-bezier(.22,.9,.37,1) forwards;
        }

        /* Intro -> March transition (staggered fade out/in) */
        .album-cover.exit .album-book,
        .album-cover.exit .album-title,
        .album-cover.exit .photo-grid-mini,
        .album-cover.exit .click-prompt {
            animation: introFadeOut 0.6s ease forwards;
        }
        .album-cover.exit .album-title { animation-delay: 0s; }
        .album-cover.exit .photo-grid-mini { animation-delay: 0.1s; }
        .album-cover.exit .album-book { animation-delay: 0.2s; }
        .album-cover.exit .click-prompt { animation-delay: 0.3s; }

        @keyframes introFadeOut {
            to { opacity: 0; transform: translateY(8px); }
        }

        .timeline-slide.first-enter .timeline-month,
        .timeline-slide.first-enter .timeline-photo,
        .timeline-slide.first-enter .timeline-text {
            opacity: 0;
            animation: introFadeIn 0.8s ease forwards;
        }
        .timeline-slide.first-enter .timeline-month { animation-delay: 0.15s; }
        .timeline-slide.first-enter .timeline-photo { animation-delay: 0.35s; }
        .timeline-slide.first-enter .timeline-text { animation-delay: 0.55s; }

        /* Stagger multiple photos in gallery (Option C enhancement) */
        .timeline-slide.first-enter .photo-gallery .scrapbook-photo {
            opacity: 0;
            animation: introFadeIn 0.8s ease forwards;
        }
        /* Single photo: standard delay */
        .timeline-slide.first-enter .photo-gallery.single-photo .scrapbook-photo { animation-delay: 0.35s; }
        /* Multiple photos: progressive stagger (150ms between each) */
        .timeline-slide.first-enter .photo-gallery:not(.single-photo) .scrapbook-photo:nth-child(1) { animation-delay: 0.35s; }
        .timeline-slide.first-enter .photo-gallery:not(.single-photo) .scrapbook-photo:nth-child(2) { animation-delay: 0.5s; }
        .timeline-slide.first-enter .photo-gallery:not(.single-photo) .scrapbook-photo:nth-child(3) { animation-delay: 0.65s; }
        .timeline-slide.first-enter .photo-gallery:not(.single-photo) .scrapbook-photo:nth-child(4) { animation-delay: 0.8s; }
        .timeline-slide.first-enter .photo-gallery:not(.single-photo) .scrapbook-photo:nth-child(5) { animation-delay: 0.95s; }
        .timeline-slide.first-enter .photo-gallery:not(.single-photo) .scrapbook-photo:nth-child(6) { animation-delay: 1.1s; }
        .timeline-slide.first-enter .photo-gallery:not(.single-photo) .scrapbook-photo:nth-child(7) { animation-delay: 1.25s; }

        @keyframes introFadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .slide.fade-in {
            animation: fadeIn 0.6s ease-out forwards;
        }

        .slide.fade-out {
            animation: fadeOut 0.6s ease-out forwards;
        }

        /* Intro Slide */
        .intro-slide {
            text-align: center;
            padding: 40px;
            background: linear-gradient(135deg, var(--primary-pink) 0%, var(--accent-red) 100%);
            color: white;
        }

        .intro-slide h1 {
            font-size: clamp(2rem, 5vw, 3.8rem);
            margin-bottom: clamp(12px, 3vw, 25px);
            animation: fadeInDown 1s ease-out;
        }

        .intro-slide p {
            font-size: clamp(1rem, 2.5vw, 1.6rem);
            font-style: italic;
            margin-bottom: clamp(15px, 4vw, 35px);
            animation: fadeInUp 1s ease-out 0.3s both;
        }

        .intro-slide .start-journey {
            font-size: 1.2rem;
            padding: 15px 40px;
            background: white;
            color: var(--accent-red);
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .intro-slide .start-journey:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        /* Timeline Slides */
        .timeline-slide {
            padding: clamp(32px, 6vh, 60px) clamp(16px, 5vw, 40px) clamp(200px, 26vh, 260px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: clamp(16px, 3.5vh, 30px);
        }

        .timeline-month {
            font-size: clamp(1.5rem, 4vw, 2.8rem);
            color: white;
            font-weight: bold;
            text-align: center;
            margin: 0 auto clamp(8px, 2vw, 15px);
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.5);
            background: rgba(255, 23, 68, 0.85);
            padding: clamp(10px, 2vw, 18px) clamp(20px, 5vw, 45px);
            border-radius: 50px;
            display: block;
            width: fit-content;
        }

        .timeline-photo {
            max-width: clamp(300px, 90vw, 650px);
            max-height: clamp(250px, 60vh, 420px);
            width: 90%;
            border-radius: clamp(12px, 3vw, 22px);
            box-shadow: 0 10px 30px rgba(255, 107, 157, 0.3);
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .timeline-photo:hover {
            transform: scale(1.05);
        }

        .message-bubble-stack {
            width: 90%;
            max-width: clamp(300px, 90vw, 650px);
            display: flex;
            flex-direction: column;
            gap: 16px;
            align-items: flex-start;
        }

        .message-bubble-card {
            width: 90%;
            max-width: clamp(300px, 90vw, 650px);
            background: #fff;
            border-radius: 22px;
            padding: 18px 20px 22px;
            box-shadow: 0 16px 40px rgba(0, 0, 0, 0.18);
            border: 1px solid rgba(255, 255, 255, 0.6);
        }

        .message-bubble-header {
            font-size: clamp(1.05rem, 2.4vw, 1.35rem);
            font-weight: 700;
            color: #1f1f1f;
            text-align: center;
            margin-bottom: 14px;
            letter-spacing: 0.3px;
        }

        .message-bubble {
            max-width: 72%;
            padding: 14px 18px;
            border-radius: 18px;
            font-size: clamp(1rem, 2.6vw, 1.3rem);
            font-weight: 600;
            color: #2b2b2b;
            position: relative;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
            opacity: 0;
            transform: translateY(12px) scale(0.98);
            animation: bubblePop 0.6s ease-out forwards;
        }

        .message-bubble.incoming {
            background: #f7d24b;
            align-self: flex-start;
        }

        .message-bubble.outgoing {
            background: #fff;
            align-self: flex-end;
        }

        .message-bubble.incoming::after {
            content: '';
            position: absolute;
            left: 10px;
            bottom: -6px;
            width: 14px;
            height: 14px;
            background: #f7d24b;
            transform: rotate(45deg);
            border-radius: 2px;
        }

        .message-bubble.outgoing::after {
            content: '';
            position: absolute;
            right: 10px;
            bottom: -6px;
            width: 14px;
            height: 14px;
            background: #fff;
            transform: rotate(45deg);
            border-radius: 2px;
        }

        .message-bubble:nth-child(1) { animation-delay: 0.1s; }
        .message-bubble:nth-child(2) { animation-delay: 0.45s; }

        @keyframes bubblePop {
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .timeline-photo-placeholder {
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2), rgba(255, 107, 157, 0.25));
            border: 2px dashed rgba(255, 255, 255, 0.6);
            color: #fff;
            text-align: center;
            padding: 20px;
            box-sizing: border-box;
        }

        .timeline-photo-placeholder::after {
            content: attr(data-alt);
            font-size: clamp(0.9rem, 2.5vw, 1.2rem);
            font-style: italic;
            text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.6);
        }

        /* Scrapbook Photo Gallery */
        .photo-gallery {
            width: min(92vw, 900px);
            max-width: 900px;
            display: flex;
            flex-wrap: wrap;
            gap: clamp(16px, 3.5vw, 34px);
            align-items: center;
            justify-content: center;
            padding: 0;
            margin: 0 auto clamp(30px, 8vh, 90px);
        }

        .scrapbook-photo {
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #fff;
            padding: 14px 14px 46px;
            border-radius: 6px;
            box-shadow: 0 16px 34px rgba(0, 0, 0, 0.32), 0 6px 14px rgba(0, 0, 0, 0.18);
            overflow: visible;
        }

        .scrapbook-photo::before {
            content: '';
            position: absolute;
            top: 14px;
            left: 14px;
            right: 14px;
            bottom: 46px;
            background-image: var(--photo-src);
            background-size: cover;
            background-position: center;
            filter: blur(6px);
            opacity: 0.18;
            z-index: 0;
            border-radius: 4px;
        }

        .scrapbook-photo::after {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 6px;
            box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.06);
            pointer-events: none;
        }

        .scrapbook-photo:hover {
            transform: scale(1.07) !important;
            z-index: 10;
            box-shadow: 0 20px 44px rgba(0, 0, 0, 0.42), 0 8px 18px rgba(0, 0, 0, 0.24);
        }

        .scrapbook-photo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            border-radius: 4px;
            background: #f7f7f7;
            position: relative;
            z-index: 1;
        }

        .polaroid-caption {
            position: absolute;
            left: 16px;
            right: 16px;
            bottom: 12px;
            font-family: 'Segoe Script', 'Bradley Hand', 'Comic Sans MS', cursive;
            font-size: clamp(0.7rem, 1.8vw, 0.95rem);
            color: #3b2f2f;
            text-align: center;
            letter-spacing: 0.3px;
            transform: rotate(-1deg);
            z-index: 2;
            pointer-events: none;
        }

        .polaroid-tape {
            position: absolute;
            width: clamp(36px, 9vw, 60px);
            height: clamp(16px, 3vw, 22px);
            background: rgba(255, 242, 198, 0.7);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.18);
            border: 1px solid rgba(232, 208, 150, 0.8);
            z-index: 3;
        }

        .polaroid-tape.left {
            top: -10px;
            left: 8px;
            transform: rotate(-12deg);
        }

        .polaroid-tape.right {
            top: -12px;
            right: 6px;
            transform: rotate(10deg);
        }

        .photo-gallery .scrapbook-photo:nth-child(1) {
            width: clamp(160px, 38vw, 240px);
            height: clamp(180px, 42vw, 280px);
            transform: rotate(-6deg);
        }

        .photo-gallery .scrapbook-photo:nth-child(2) {
            width: clamp(145px, 34vw, 220px);
            height: clamp(165px, 38vw, 260px);
            transform: rotate(5deg);
        }

        .photo-gallery .scrapbook-photo:nth-child(3) {
            width: clamp(150px, 36vw, 230px);
            height: clamp(170px, 40vw, 270px);
            transform: rotate(-4deg);
        }

        .photo-gallery .scrapbook-photo:nth-child(4) {
            width: clamp(148px, 35vw, 225px);
            height: clamp(168px, 39vw, 265px);
            transform: rotate(7deg);
        }

        .photo-gallery .scrapbook-photo:nth-child(5) {
            width: clamp(152px, 36vw, 228px);
            height: clamp(172px, 40vw, 268px);
            transform: rotate(-5deg);
        }

        .photo-gallery .scrapbook-photo:nth-child(6) {
            width: clamp(146px, 34vw, 222px);
            height: clamp(166px, 38vw, 262px);
            transform: rotate(6deg);
        }

        .photo-gallery .scrapbook-photo:nth-child(7) {
            width: clamp(150px, 35vw, 226px);
            height: clamp(170px, 39vw, 266px);
            transform: rotate(-7deg);
        }

        .photo-gallery.single-photo .scrapbook-photo {
            width: clamp(260px, 75vw, 480px);
            height: clamp(300px, 82vw, 560px);
            transform: rotate(-2deg);
        }

        /* Many photos (5+) - smaller sizes to fit more */
        .photo-gallery.many-photos {
            gap: clamp(12px, 2.5vw, 25px);
        }

        .photo-gallery.many-photos .scrapbook-photo:nth-child(1) {
            width: clamp(130px, 30vw, 200px);
            height: clamp(150px, 34vw, 230px);
        }

        .photo-gallery.many-photos .scrapbook-photo:nth-child(2) {
            width: clamp(120px, 28vw, 185px);
            height: clamp(140px, 32vw, 215px);
        }

        .photo-gallery.many-photos .scrapbook-photo:nth-child(3) {
            width: clamp(125px, 29vw, 190px);
            height: clamp(145px, 33vw, 220px);
        }

        .photo-gallery.many-photos .scrapbook-photo:nth-child(4) {
            width: clamp(122px, 28vw, 188px);
            height: clamp(142px, 32vw, 218px);
        }

        .photo-gallery.many-photos .scrapbook-photo:nth-child(5) {
            width: clamp(128px, 29vw, 192px);
            height: clamp(148px, 33vw, 222px);
        }

        .photo-gallery.many-photos .scrapbook-photo:nth-child(6) {
            width: clamp(118px, 27vw, 182px);
            height: clamp(138px, 31vw, 212px);
        }

        .photo-gallery.many-photos .scrapbook-photo:nth-child(7) {
            width: clamp(124px, 28vw, 186px);
            height: clamp(144px, 32vw, 216px);
        }

        /* Photo Lightbox */
        .photo-lightbox {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.95);
            z-index: 4000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
            padding: 20px;
            box-sizing: border-box;
        }

        .photo-lightbox.active {
            opacity: 1;
            visibility: visible;
        }

        .lightbox-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid white;
            color: white;
            width: 46px;
            height: 46px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            transition: all 0.3s ease;
        }

        .lightbox-close:hover {
            background: white;
            color: var(--accent-red);
            transform: scale(1.1);
        }

        .lightbox-photo-container {
            max-width: 90vw;
            max-height: 70vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .lightbox-photo {
            max-width: 100%;
            max-height: 60vh;
            object-fit: contain;
            border-radius: 8px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .lightbox-caption {
            color: white;
            font-size: clamp(1rem, 2.5vw, 1.3rem);
            text-align: center;
            max-width: 600px;
            line-height: 1.6;
            padding: 0 20px;
        }

        .lightbox-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.15);
            border: 2px solid white;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 1.8rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            z-index: 10;
        }

        .lightbox-nav:hover {
            background: white;
            color: var(--accent-red);
            transform: translateY(-50%) scale(1.1);
        }

        .lightbox-nav.prev { left: 20px; }
        .lightbox-nav.next { right: 20px; }
        .lightbox-nav.hidden { display: none; }

        @media (max-width: 768px) {
            .lightbox-nav {
                width: 44px;
                height: 44px;
                font-size: 1.5rem;
            }
            .lightbox-close {
                width: 42px;
                height: 42px;
                top: 15px;
                right: 15px;
            }

            /* Adjust many-photos gallery for mobile */
            .photo-gallery.many-photos {
                gap: clamp(10px, 2vw, 18px);
            }

            .photo-gallery.many-photos .scrapbook-photo {
                width: clamp(110px, 26vw, 160px) !important;
                height: clamp(130px, 30vw, 190px) !important;
            }
        }

        @media (max-height: 720px) {
            .timeline-slide {
                padding: clamp(24px, 4vh, 40px) clamp(14px, 4vw, 28px);
                gap: clamp(12px, 2.8vh, 22px);
            }

            .photo-gallery {
                gap: clamp(12px, 2.5vw, 24px);
            }

            .photo-gallery .scrapbook-photo {
                width: clamp(120px, 30vw, 200px) !important;
                height: clamp(140px, 34vw, 230px) !important;
            }

            .photo-gallery.single-photo .scrapbook-photo {
                width: clamp(220px, 70vw, 420px) !important;
                height: clamp(260px, 78vw, 500px) !important;
            }
        }

        .timeline-text {
            text-align: center;
            font-size: clamp(0.95rem, 2.5vw, 1.4rem);
            max-width: clamp(280px, 90vw, 750px);
            color: white;
            font-style: italic;
            line-height: 1.6;
            text-shadow: 2px 2px 6px rgba(0, 0, 0, 0.7);
            background: rgba(255, 23, 68, 0.75);
            padding: clamp(15px, 3vw, 25px) clamp(20px, 4vw, 35px);
            border-radius: clamp(10px, 2vw, 18px);
            margin: 0 auto;
        }

        /* Love Letter Slide */
        .letter-slide {
            padding: clamp(30px, 6vw, 70px) clamp(16px, 4vw, 45px);
            max-width: clamp(280px, 90vw, 950px);
            margin: 0 auto;
            text-align: left;
            overflow-y: auto;
            min-height: 100vh;
        }

        .letter-slide h2 {
            font-size: clamp(1.8rem, 4vw, 2.8rem);
            color: var(--accent-red);
            text-align: center;
            margin-bottom: clamp(20px, 4vw, 35px);
            text-shadow: 1px 1px 4px rgba(255, 255, 255, 0.8);
        }

        .letter-slide .letter-date {
            text-align: right;
            font-style: italic;
            color: #333;
            margin-bottom: clamp(12px, 2vw, 20px);
            font-weight: 500;
            font-size: clamp(0.85rem, 1.5vw, 1rem);
        }

        .letter-slide .letter-content {
            font-size: clamp(0.95rem, 2.2vw, 1.3rem);
            line-height: 1.8;
            color: #333;
            margin-bottom: clamp(15px, 2.5vw, 25px);
            background: rgba(255, 255, 255, 0.85);
            padding: clamp(15px, 4vw, 35px);
            border-radius: clamp(10px, 2vw, 18px);
            box-shadow: 0 4px 15px rgba(255, 107, 157, 0.2);
        }

        .letter-slide .letter-content p {
            margin-bottom: 20px;
        }

        .letter-slide .letter-signature {
            text-align: right;
            font-size: 1.3rem;
            font-style: italic;
            margin-top: 40px;
            color: var(--accent-red);
            background: rgba(255, 255, 255, 0.85);
            padding: 20px 30px;
            border-radius: 15px;
            float: right;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes glow {
            0%, 100% {
                box-shadow: 0 0 10px rgba(255, 107, 157, 0.5), 0 0 20px rgba(255, 23, 68, 0.3);
            }
            50% {
                box-shadow: 0 0 20px rgba(255, 107, 157, 0.8), 0 0 40px rgba(255, 23, 68, 0.6);
            }
        }

        @keyframes scaleInBounce {
            0% {
                opacity: 0;
                transform: scale(0.8);
            }
            70% {
                opacity: 1;
                transform: scale(1.05);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes floatHearts {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-15px);
            }
        }

        @keyframes heartPulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.2);
            }
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(50px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes fadeOutScale {
            from {
                opacity: 1;
                transform: scale(1);
            }
            to {
                opacity: 0;
                transform: scale(0.95);
            }
        }

        @keyframes scaleOutBounce {
            0% {
                opacity: 1;
                transform: scale(1);
            }
            100% {
                opacity: 0;
                transform: scale(0.8) translateY(-20px);
            }
        }

        @keyframes fadeOutUp {
            from {
                opacity: 1;
                transform: translateY(0);
            }
            to {
                opacity: 0;
                transform: translateY(-30px);
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
            }
            to {
                opacity: 0;
            }
        }

        /* Navigation Arrows */
        .nav-arrow {
            position: fixed;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.9);
            color: var(--accent-red);
            border: none;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            font-size: 2rem;
            cursor: pointer;
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 107, 157, 0.3);
            pointer-events: auto;
        }
        
        .nav-arrow.disabled {
            display: none;
        }

        .nav-arrow:hover {
            background: var(--primary-pink);
            color: white;
            transform: translateY(-50%) scale(1.1);
        }

        .nav-arrow.prev {
            left: 20px;
        }

        .nav-arrow.next {
            right: 20px;
        }

        .nav-arrow.hidden {
            display: none;
        }

        /* Timeline Slider at Bottom */
        .timeline-slider {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            padding: clamp(12px, 3vw, 20px);
            z-index: 1000;
            box-shadow: 0 -4px 15px rgba(255, 107, 157, 0.2);
            transition: opacity 0.3s ease, visibility 0.3s ease;
            display: flex;
            justify-content: center;
        }
        
        .timeline-slider.disabled {
            display: none;
        }

        .slider-track {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: clamp(6px, 1.5vw, 12px);
            max-width: 100%;
            width: auto;
            overflow-x: auto;
            padding: clamp(8px, 2vw, 16px) clamp(16px, 4vw, 40px);
            scroll-snap-type: x mandatory;
            scroll-padding: clamp(8px, 2vw, 16px) clamp(16px, 4vw, 40px);
            -webkit-overflow-scrolling: touch;
        }

        .slider-track::-webkit-scrollbar {
            height: clamp(6px, 1.5vw, 10px);
        }

        .timeline-dot {
            scroll-snap-align: center;
            flex: 0 0 auto;
        }

        .slider-track::-webkit-scrollbar-track {
            background: var(--secondary-pink);
            border-radius: 10px;
        }

        .slider-track::-webkit-scrollbar-thumb {
            background: var(--primary-pink);
            border-radius: 10px;
        }

        .timeline-dot {
            min-width: clamp(50px, 10vw, 90px);
            width: clamp(50px, 10vw, 90px);
            height: clamp(50px, 10vw, 90px);
            flex: 0 0 auto;
            border-radius: 50%;
            background: var(--secondary-pink);
            border: clamp(2px, 0.5vw, 4px) solid var(--primary-pink);
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: clamp(0.6rem, 1.5vw, 0.9rem);
            text-align: center;
            padding: clamp(3px, 0.8vw, 6px);
            transform-origin: center;
        }

        .timeline-dot:hover {
            transform: scale(1.15);
            box-shadow: 0 4px 15px rgba(255, 107, 157, 0.4);
        }

        .timeline-dot.active {
            background: var(--primary-pink);
            color: white;
            border-color: var(--accent-red);
            transform: scale(1.2);
        }

        .timeline-dot.glowing {
            animation: glow 1.5s ease-in-out infinite;
            border-color: var(--accent-red);
            background: var(--primary-pink);
            color: white;
        }

        .timeline-dot.letter-dot {
            background: white !important;
            color: var(--accent-red) !important;
            border: 3px solid var(--accent-red) !important;
            font-size: 1rem !important;
            padding: 8px 5px !important;
        }

        .timeline-dot.letter-dot span {
            line-height: 1.2;
            font-size: 0.9em;
        }

        .timeline-dot.letter-dot:hover {
            background: var(--soft-white) !important;
            transform: scale(1.15);
        }

        .timeline-dot.letter-dot.active {
            background: white !important;
            color: var(--accent-red) !important;
            border: 3px solid var(--accent-red) !important;
            transform: scale(1.2);
        }

        .timeline-dot.intro {
            display: none;
        }

        .timeline-dot.hidden {
            display: none;
        }

        /* Audio Controls */
        .audio-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: white;
            border-radius: 50%;
            padding: 15px;
            width: 60px;
            height: 60px;
            box-shadow: 0 4px 15px rgba(255, 107, 157, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: none;
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .audio-btn:hover,
        .audio-btn:active,
        .audio-btn:focus {
            width: auto;
            padding: 15px 20px;
            border-radius: 30px;
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 6px 20px rgba(255, 107, 157, 0.4);
        }

        .audio-icon {
            font-size: 1.5rem;
            color: var(--primary-pink);
        }

        .audio-text {
            display: none;
            margin-left: 8px;
            font-weight: 600;
            color: var(--text-dark);
            white-space: nowrap;
            align-items: center;
            gap: 8px;
        }

        .audio-btn:hover .audio-text,
        .audio-btn:active .audio-text,
        .audio-btn:focus .audio-text {
            display: flex;
        }

        .audio-play {
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .audio-play:hover {
            transform: scale(1.2);
        }

        /* Extra Large Screen (1920px+) */
        @media (min-width: 1920px) {
            .timeline-dot {
                min-width: 100px;
                width: 100px;
                height: 100px;
                font-size: 0.95rem;
            }

            .nav-arrow {
                width: 70px;
                height: 70px;
                font-size: 2.2rem;
            }
        }

        /* Large Screen (1280px - 1919px) */
        @media (max-width: 1919px) and (min-width: 1280px) {
            .nav-arrow {
                width: 65px;
                height: 65px;
                font-size: 2rem;
            }
        }

        /* Tablet (769px - 1279px) */
        @media (max-width: 1279px) and (min-width: 769px) {
            .slide {
                padding: clamp(20px, 4vw, 30px) clamp(15px, 3vw, 25px) clamp(160px, 22vh, 210px);
            }

            .nav-arrow {
                width: clamp(50px, 5vw, 62px);
                height: clamp(50px, 5vw, 62px);
                font-size: clamp(1.3rem, 2vw, 1.8rem);
            }

            /* Timeline adjustments for tablet */
            .timeline-slider {
                padding: clamp(10px, 2vw, 14px);
            }

            .slider-track {
                padding: 10px clamp(12px, 3vw, 30px) !important;
                gap: clamp(8px, 2vw, 14px);
            }

            .timeline-dot {
                min-width: 90px;
                width: 90px;
                height: 90px;
                font-size: 0.8rem;
                border: 3px solid var(--primary-pink);
            }

            .timeline-dot.letter-dot {
                font-size: 0.9rem !important;
                padding: 7px 4px !important;
            }

            .timeline-dot.letter-dot span {
                font-size: 0.95em;
            }
        }

        /* Tablet Landscape (iPad Air ~1180px width, ~820px height) */
        @media (max-width: 1279px) and (min-width: 769px) and (orientation: landscape) {
            .slide {
                padding: clamp(16px, 3vw, 24px) clamp(12px, 2vw, 20px) clamp(150px, 22vh, 200px);
            }

            .timeline-slider {
                padding: 8px;
                height: auto;
            }

            .slider-track {
                padding: 8px clamp(10px, 2vw, 24px) !important;
                gap: 10px;
            }

            .timeline-dot {
                min-width: 80px;
                width: 80px;
                height: 80px;
                font-size: 0.75rem;
            }

            .timeline-month {
                font-size: clamp(1.8rem, 3vw, 2.4rem);
                padding: clamp(8px, 1.5vw, 14px) clamp(16px, 3vw, 32px);
            }

            .timeline-text {
                font-size: clamp(0.9rem, 2vw, 1.2rem);
                padding: clamp(12px, 2vw, 18px) clamp(16px, 3vw, 28px);
            }

            /* Closing overlay in landscape */
            #closingOverlay .closing-content,
            .closing-content {
                padding: 16px 12px 20px !important;
                gap: 4px !important;
            }

            .closing-title {
                font-size: clamp(1.8rem, 3.5vw, 2.6rem) !important;
                margin-bottom: 12px !important;
            }

            .closing-text {
                font-size: clamp(0.9rem, 2vw, 1.1rem) !important;
                margin-bottom: 4px !important;
            }

            .closing-hearts {
                font-size: clamp(1.6rem, 3vw, 2.4rem) !important;
                margin: 12px 0 !important;
            }

            .closing-footer {
                font-size: clamp(1.1rem, 2.5vw, 1.6rem) !important;
                margin-bottom: 12px !important;
            }

            .replay-btn {
                padding: 10px 30px;
                font-size: 1rem;
            }

            .closing-meta {
                font-size: 0.6rem !important;
                bottom: 4px !important;
            }
        }

        /* Small Tablet (481px - 768px) */
        @media (max-width: 768px) and (min-width: 481px) {
            .slide {
                padding: clamp(24px, 4vw, 30px) clamp(16px, 3vw, 20px) clamp(150px, 22vh, 200px);
            }

            .album-container {
                gap: clamp(20px, 4vw, 28px);
            }

            .album-title {
                font-size: clamp(1.8rem, 4vw, 2.2rem);
            }

            .photo-grid-mini {
                gap: clamp(6px, 1.5vw, 10px);
            }

            .mini-photo {
                font-size: clamp(0.6rem, 1vw, 0.85rem);
            }

            .nav-arrow {
                width: clamp(48px, 5vw, 56px);
                height: clamp(48px, 5vw, 56px);
                font-size: clamp(1.2rem, 2.5vw, 1.6rem);
                left: clamp(8px, 3vw, 12px);
                right: clamp(8px, 3vw, 12px);
            }

            .nav-arrow.prev {
                left: clamp(8px, 3vw, 12px);
            }

            .nav-arrow.next {
                right: clamp(8px, 3vw, 12px);
            }

            .restart-btn {
                width: 50px;
                height: 50px;
                top: 10px;
                left: 10px;
                padding: 12px;
            }

            .audio-btn {
                width: 50px;
                height: 50px;
                top: 10px;
                right: 10px;
                padding: 12px;
            }
        }

        /* Small Mobile (320px - 480px) */
        @media (max-width: 480px) {
            .slide {
                padding: clamp(20px, 3vw, 24px) clamp(12px, 2vw, 16px) clamp(150px, 24vh, 210px);
                min-height: 100vh;
            }

            .album-container {
                gap: clamp(16px, 3vw, 20px);
            }

            .album-title {
                font-size: clamp(1.6rem, 3.5vw, 1.9rem);
            }

            .album-book {
                width: clamp(220px, 80vw, 280px);
                height: clamp(300px, 110vw, 380px);
                perspective: 1000px;
            }

            .photo-grid-mini {
                gap: clamp(5px, 1vw, 8px);
            }

            .mini-photo {
                font-size: clamp(0.5rem, 0.9vw, 0.7rem);
            }

            .timeline-photo {
                max-height: clamp(180px, 50vh, 240px);
            }

            .envelope {
                width: clamp(200px, 85vw, 260px);
                height: clamp(140px, 50vw, 180px);
            }

            .envelope-flap {
                border-left: clamp(100px, 42.5vw, 130px) solid transparent;
                border-right: clamp(100px, 42.5vw, 130px) solid transparent;
                border-top: clamp(70px, 35vw, 90px) solid var(--accent-red);
            }

            .nav-arrow {
                width: clamp(44px, 4vw, 50px);
                height: clamp(44px, 4vw, 50px);
                font-size: clamp(1rem, 2vw, 1.4rem);
                left: clamp(6px, 2vw, 10px);
                right: clamp(6px, 2vw, 10px);
            }

            .restart-btn {
                width: 50px;
                height: 50px;
                top: 10px;
                left: 10px;
                padding: 12px;
            }

            .audio-btn {
                width: 50px;
                height: 50px;
                top: 10px;
                right: 10px;
                padding: 12px;
            }

            .audio-icon {
                font-size: clamp(1.2rem, 2.5vw, 1.6rem);
            }
        }

        /* Mobile Landscape (phones like iPhone 14 Pro Max) */
        @media (max-height: 600px) and (orientation: landscape) {
            /* HIDE timeline for landscape */
            .timeline-slider {
                display: none !important;
            }

            .slide {
                padding: 10px 10px 16px !important;
            }

            .timeline-slide {
                gap: 10px;
            }

            .timeline-month {
                font-size: clamp(1.3rem, 3vw, 1.7rem) !important;
                padding: 6px 14px !important;
                margin-bottom: 4px !important;
            }

            .timeline-photo {
                max-height: clamp(120px, 42vh, 180px) !important;
            }

            .timeline-text {
                font-size: clamp(0.8rem, 1.8vw, 0.95rem) !important;
                padding: 8px 12px !important;
            }

            /* Intro overlay compact splash */
            .album-container {
                width: 100%;
                padding: 0 16px;
                gap: 10px;
            }

            .album-book,
            .click-prompt {
                display: none;
            }

            .intro-compact {
                display: flex;
                margin-top: 10px;
            }

            /* Enhanced envelope for mobile landscape */
            .envelope-container {
                gap: 16px;
                padding-top: 6px;
            }

            .envelope {
                width: clamp(200px, 60vw, 280px);
                height: clamp(140px, 45vw, 200px);
            }

            .envelope.active {
                animation: envelopeBounceIntense 0.6s ease-in-out infinite;
            }

            .envelope-body {
                box-shadow: 0 10px 35px rgba(255, 107, 157, 0.5);
            }

            .envelope-prompt {
                font-size: clamp(1rem, 2.8vw, 1.4rem) !important;
                margin-top: 0;
            }

            .envelope-prompt p {
                font-size: clamp(0.95rem, 2.6vw, 1.2rem) !important;
            }

            /* Instruction text for mobile landscape */
            .envelope-instruction {
                display: block !important;
                text-align: center;
                color: var(--primary-pink);
                font-style: italic;
                font-size: clamp(0.9rem, 2.5vw, 1.05rem);
                margin-top: 8px;
                animation: fadeInUp 0.6s ease-out 0.3s both;
            }

            .nav-arrow {
                width: 42px;
                height: 42px;
                font-size: 0.95rem;
            }

            .restart-btn {
                width: 40px;
                height: 40px;
                top: 10px;
                left: 8px;
                padding: 10px;
            }

            .audio-btn {
                width: 40px;
                height: 40px;
                top: 10px;
                right: 8px;
                padding: 10px;
            }

            .audio-icon {
                font-size: 1.1rem;
            }
        }

        /* Extra Small Mobile (< 320px) */
        @media (max-width: 319px) {
            .slide {
                padding: 16px 10px 150px;
            }

            .timeline-dot {
                min-width: 45px;
                width: 45px;
                height: 45px;
                font-size: 0.55rem;
            }

            .nav-arrow {
                width: 42px;
                height: 42px;
                font-size: 1rem;
            }
        }

        /* Legacy Responsive Design (for compatibility) */
        @media (max-width: 768px) {
            /* Handled above in range-based queries */
        }

        /* Valentine's Day Lock Overlay */
        .lock-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--primary-pink) 0%, var(--accent-red) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 5000;
            opacity: 1;
            visibility: visible;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .lock-overlay.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        .lock-content {
            text-align: center;
            color: white;
            padding: clamp(20px, 4vw, 50px) clamp(16px, 3vw, 30px);
            max-width: clamp(280px, 90vw, 600px);
            animation: scaleInBounce 0.8s cubic-bezier(.22,.9,.37,1) ease-out;
        }

        .lock-icon {
            font-size: clamp(3rem, 8vw, 6rem);
            margin-bottom: clamp(12px, 3vw, 25px);
            animation: heartPulse 1.5s ease-in-out infinite;
        }

        .lock-content h1 {
            font-size: clamp(1.8rem, 4vw, 2.8rem);
            margin-bottom: clamp(12px, 3vw, 25px);
            animation: fadeInDown 1s ease-out 0.2s both;
        }

        .lock-content p {
            font-size: clamp(0.95rem, 2.2vw, 1.3rem);
            margin: clamp(8px, 1.5vw, 18px) 0;
            animation: fadeInUp 1s ease-out 0.4s both;
        }

        .countdown-text {
            font-size: clamp(1rem, 2.5vw, 1.5rem);
            font-weight: bold;
            margin-top: clamp(15px, 4vw, 35px) !important;
        }

        /* Album Cover (Intro Page) */
        #introOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--primary-pink) 0%, var(--accent-red) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            cursor: pointer;
            transition: opacity 0.65s ease, visibility 0.65s ease;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        #introOverlay.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        #introOverlay.exit {
            animation: fadeOutScale 0.65s ease forwards;
            pointer-events: none !important;
        }

        #introOverlay.exit .album-container {
            animation: scaleOutBounce 0.65s cubic-bezier(.22,.9,.37,1) ease-out forwards;
        }

        #introOverlay.exit .album-title {
            animation: fadeOutUp 0.4s ease-out forwards;
        }

        #introOverlay.exit .album-book {
            animation: fadeOutScale 0.5s ease-out 0.1s forwards;
        }

        #introOverlay.exit .click-prompt {
            animation: fadeOut 0.3s ease-out forwards;
        }

        .album-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 40px;
            animation: scaleInBounce 1s cubic-bezier(.22,.9,.37,1) ease-out;
        }

        .intro-compact {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 10px;
            text-align: center;
            color: white;
            cursor: pointer;
        }

        body.landscape-compact .album-book,
        body.landscape-compact .click-prompt {
            display: none;
        }

        body.landscape-compact .intro-compact {
            display: flex;
            margin-top: 10px;
        }

        .intro-compact-title {
            font-size: clamp(1.6rem, 4vw, 2.2rem);
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .intro-compact-heart {
            font-size: clamp(1.6rem, 4vw, 2.4rem);
            animation: heartPulse 1.5s ease-in-out infinite;
        }

        .intro-compact-text {
            font-size: clamp(0.95rem, 2.5vw, 1.2rem);
            font-style: italic;
            opacity: 0.9;
        }

        .album-container .album-book {
            animation: fadeInUp 0.8s ease-out 0.2s both;
        }

        .album-container .click-prompt {
            animation: fadeInUp 0.8s ease-out 0.5s both, pulse 2s ease-in-out 1.3s infinite;
        }

        .album-book {
            width: clamp(240px, 85vw, 400px);
            height: clamp(320px, 110vw, 540px);
            perspective: 1000px;
            transition: transform 0.3s ease;
        }

        .album-book:hover {
            transform: scale(1.05);
        }

        .album-front {
            width: 100%;
            height: 100%;
            background: white;
            border-radius: clamp(8px, 2vw, 14px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: clamp(16px, 3vw, 35px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: clamp(16px, 3vw, 35px);
        }

        .album-title {
            font-size: clamp(1.8rem, 4vw, 2.8rem);
            color: var(--accent-red);
            font-weight: bold;
            font-family: 'Georgia', serif;
            opacity: 0;
            animation: fadeInScale 0.6s ease-out 0.35s forwards;
        }

        .photo-grid-mini {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: clamp(6px, 1.5vw, 12px);
            width: 100%;
        }

        .mini-photo {
            aspect-ratio: 1;
            background: linear-gradient(135deg, var(--secondary-pink), var(--primary-pink));
            border-radius: clamp(6px, 1.5vw, 10px);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
            color: white;
            font-weight: 700;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            opacity: 0;
            animation: fadeInScale 0.6s ease-out forwards;
        }

        .mini-photo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            opacity: 1;
            transition: opacity 0.45s ease;
            filter: blur(6px);
            transform: scale(1.05);
        }

        .mini-photo.placeholder::after {
            content: attr(data-alt);
            padding: 6px;
            text-align: center;
        }

        .mini-photo:nth-child(1) { animation-delay: 0.4s; }
        .mini-photo:nth-child(2) { animation-delay: 0.5s; }
        .mini-photo:nth-child(3) { animation-delay: 0.6s; }
        .mini-photo:nth-child(4) { animation-delay: 0.7s; }

        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .click-prompt {
            display: flex;
            align-items: center;
            gap: 15px;
            color: white;
            font-size: 1.5rem;
            animation: pulse 2s infinite;
        }

        .prompt-text {
            font-style: italic;
            font-size: 1.8rem;
        }

        .arrow-left, .arrow-right, .arrow-up {
            font-size: 1.8rem;
            animation: bounce 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(10px); }
        }

        /* Envelope Slide */
        .envelope-slide {
            background: linear-gradient(135deg, var(--soft-white) 0%, var(--secondary-pink) 100%);
        }

        .envelope-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 40px;
        }

        .envelope {
            width: clamp(220px, 80vw, 380px);
            height: clamp(160px, 50vw, 270px);
            position: relative;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .envelope:hover {
            animation: none;
            transform: scale(1.05);
        }

        .envelope:active {
            animation: none;
        }

        .envelope.active {
            animation: envelopeBeat 1.4s ease-in-out infinite;
        }

        @keyframes envelopeBeat {
            0%, 100% {
                transform: translateY(0) scale(1);
            }
            20% {
                transform: translateY(-6px) scale(1.03);
            }
            40% {
                transform: translateY(0) scale(1);
            }
            60% {
                transform: translateY(-10px) scale(1.06);
            }
            80% {
                transform: translateY(0) scale(1);
            }
        }

        @keyframes envelopeBounceIntense {
            0%, 100% {
                transform: translateY(0) scale(1);
                box-shadow: 0 10px 30px rgba(255, 107, 157, 0.3);
            }
            50% {
                transform: translateY(-20px) scale(1.08);
                box-shadow: 0 15px 40px rgba(255, 107, 157, 0.6);
            }
        }

        .envelope-body {
            width: 100%;
            height: 100%;
            background: white;
            border: clamp(2px, 0.5vw, 4px) solid var(--primary-pink);
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 30px rgba(255, 107, 157, 0.3);
        }

        .envelope-flap {
            width: 0;
            height: 0;
            border-left: clamp(110px, 40vw, 190px) solid transparent;
            border-right: clamp(110px, 40vw, 190px) solid transparent;
            border-top: clamp(80px, 35vw, 140px) solid var(--accent-red);
            position: absolute;
            top: 0;
            left: 0;
            transform-origin: top;
            transition: transform 1.6s cubic-bezier(.22,.9,.37,1);
            z-index: 2;
        }

        .envelope:hover .envelope-flap {
            transform: rotateX(-10deg);
            transition-duration: 0.4s;
        }

        .wax-seal {
            font-size: clamp(2rem, 5vw, 3.5rem);
            animation: heartbeat 1.5s infinite;
        }

        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.1); }
            50% { transform: scale(1); }
        }

        .letter-peek {
            width: clamp(180px, 75vw, 310px);
            height: clamp(120px, 45vw, 200px);
            background: var(--soft-white);
            position: absolute;
            top: clamp(8px, 2vw, 22px);
            left: 50%;
            transform: translateX(-50%);
            border-radius: clamp(4px, 1vw, 8px);
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.1);
        }

        .envelope-prompt {
            text-align: center;
            color: var(--accent-red);
            font-size: clamp(1rem, 2.5vw, 1.7rem);
            font-style: italic;
        }

        .envelope-instruction {
            display: none;
            text-align: center;
            color: var(--primary-pink);
            font-style: italic;
            font-size: 1rem;
            margin-top: 8px;
            animation: fadeInUp 0.6s ease-out 0.3s both;
        }

        /* Letter Overlay Styles */
        .letter-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3100;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.8s ease, visibility 0.8s ease;
            pointer-events: none;
        }

        .letter-overlay.active {
            pointer-events: auto;
            opacity: 1;
            visibility: visible;
        }

        .letter-paper {
            background: var(--soft-white);
            max-width: 900px;
            width: 90%;
            max-height: 85vh;
            overflow: hidden;
            border-radius: 18px;
            box-shadow: 0 20px 60px rgba(255, 107, 157, 0.5);
            position: relative;
            opacity: 0;
            transform: scale(0.72) translateY(60px);
            transition: transform 1.6s cubic-bezier(.22,.9,.37,1), opacity 1.6s ease;
        }

        .letter-body {
            max-height: 85vh;
            overflow-y: auto;
            padding: 90px 50px 50px;
            box-sizing: border-box;
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.8s ease, transform 0.8s ease;
        }

        .letter-overlay.active .letter-paper {
            opacity: 1;
            transform: scale(1) translateY(0);
        }

        .letter-overlay.revealed .letter-body {
            opacity: 1;
            transform: translateY(0);
        }

        .close-letter-x {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--accent-red);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            z-index: 10;
        }

        .close-letter-x:hover {
            background: var(--primary-pink);
            transform: scale(1.1);
        }

        .letter-paper h2 {
            font-size: 2.5rem;
            color: var(--accent-red);
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 1px 1px 4px rgba(255, 255, 255, 0.8);
        }

        .letter-paper .letter-date {
            text-align: right;
            font-style: italic;
            color: #333;
            margin-bottom: 30px;
            font-weight: 500;
        }

        .letter-paper .letter-content {
            font-size: 1.2rem;
            line-height: 1.8;
            color: #333;
            margin-bottom: 20px;
        }

        .letter-paper .letter-content p {
            margin-bottom: 20px;
        }

        .letter-paper .letter-signature {
            text-align: right;
            font-size: 1.3rem;
            font-style: italic;
            margin-top: 40px;
            color: var(--accent-red);
        }

        .envelope.opened .envelope-flap {
            transform: rotateX(-180deg);
            transition-duration: 1.6s;
        }

        .envelope.opened {
            animation: none;
        }

        /* Closing Overlay (Outside Slideshow) */
        #closingOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--accent-red) 0%, var(--primary-pink) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3050;
            color: white;
            text-align: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.65s ease, visibility 0.65s ease;
            pointer-events: none;
            overflow-y: auto;
        }

        #closingOverlay.active {
            opacity: 1;
            visibility: visible;
            pointer-events: auto;
        }

        #closingOverlay.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        #closingOverlay .closing-carousel {
            position: absolute;
            inset: 0;
            overflow: hidden;
            opacity: 0;
            transition: opacity 1s ease;
            pointer-events: none;
            z-index: 1;
        }

        #closingOverlay.active .closing-carousel {
            opacity: 0.35;
        }

        .closing-carousel-row {
            position: absolute;
            left: 0;
            right: 0;
            overflow: hidden;
            height: 22%;
        }

        .closing-carousel-row:nth-child(1) { top: 6%; }
        .closing-carousel-row:nth-child(2) { top: 30%; }
        .closing-carousel-row:nth-child(3) { top: 54%; }
        .closing-carousel-row:nth-child(4) { top: 78%; }

        .closing-carousel-track {
            display: flex;
            gap: 18px;
            width: max-content;
            align-items: center;
            animation: carousel-left 60s linear infinite;
        }

        .closing-carousel-row.right .closing-carousel-track {
            animation: carousel-right 70s linear infinite;
        }

        .closing-carousel-item {
            width: clamp(120px, 18vw, 240px);
            aspect-ratio: 4 / 3;
            border-radius: 14px;
            overflow: hidden;
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.25);
        }

        .closing-carousel-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        @keyframes carousel-left {
            from { transform: translateX(0); }
            to { transform: translateX(-50%); }
        }

        @keyframes carousel-right {
            from { transform: translateX(-50%); }
            to { transform: translateX(0); }
        }

        #closingOverlay .closing-content {
            min-height: auto !important;
            position: relative;
        }

        /* Closing Slide */
        .closing-slide {
            background: linear-gradient(135deg, var(--accent-red) 0%, var(--primary-pink) 100%);
            color: white;
            text-align: center;
            overflow-y: auto;
        }

        .closing-content {
            max-width: clamp(280px, 90vw, 850px);
            width: 100%;
            padding: clamp(30px, 5vw, 50px) clamp(16px, 3vw, 28px) clamp(60px, 12vh, 100px);
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: clamp(6px, 1.5vw, 12px);
            position: relative;
            z-index: 2;
        }

        #closingOverlay.active .closing-content {
            animation: scaleInBounce 0.8s cubic-bezier(.22,.9,.37,1) ease-out;
        }

        .closing-meta {
            position: fixed;
            left: 50%;
            bottom: clamp(6px, 1.5vw, 10px);
            transform: translateX(-50%);
            opacity: 0.55;
            font-size: clamp(0.65rem, 1.2vw, 0.85rem);
            margin-top: 0;
            z-index: 3060;
        }

        .closing-title {
            font-size: clamp(2rem, 5vw, 3.5rem);
            margin-bottom: clamp(24px, 5vw, 45px);
            opacity: 0;
        }

        #closingOverlay.active .closing-title {
            animation: fadeInDown 1s ease-out 0.2s both;
        }

        .closing-text {
            font-size: clamp(1rem, 2.5vw, 1.6rem);
            margin-bottom: clamp(12px, 2vw, 22px);
            font-style: italic;
            opacity: 0;
        }

        #closingOverlay.active .closing-text:nth-child(2) { animation: fadeInUp 0.8s ease-out 0.5s both; }
        #closingOverlay.active .closing-text:nth-child(3) { animation: fadeInUp 0.8s ease-out 0.8s both; }
        #closingOverlay.active .closing-text:nth-child(4) { animation: fadeInUp 0.8s ease-out 1.1s both; }

        .closing-hearts {
            font-size: clamp(2rem, 5vw, 3.5rem);
            margin: clamp(24px, 4vw, 45px) 0;
            opacity: 0;
        }

        #closingOverlay.active .closing-hearts {
            animation: fadeIn 1s ease-out 1.4s both;
        }

        .closing-footer {
            font-size: clamp(1.3rem, 3vw, 2rem);
            margin-bottom: clamp(24px, 4vw, 45px);
            font-weight: bold;
            opacity: 0;
        }

        #closingOverlay.active .closing-footer {
            animation: fadeIn 1s ease-out 1.7s both;
        }

        .replay-btn {
            padding: 15px 40px;
            background: white;
            color: var(--accent-red);
            border: none;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            opacity: 0;
        }

        #closingOverlay.active .replay-btn {
            animation: fadeIn 1s ease-out 2s both;
        }

        .replay-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
            animation: heartPulse 0.6s ease-in-out;
        }

        .timeline-slider.hidden {
            display: none;
        }

        .restart-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
            background: white;
            border-radius: 50%;
            padding: 15px;
            width: 60px;
            height: 60px;
            box-shadow: 0 4px 15px rgba(255, 107, 157, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: none;
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .restart-btn .restart-icon {
            font-size: 1.5rem;
            color: var(--primary-pink);
        }

        .restart-btn .restart-text {
            display: none;
            margin-left: 8px;
            font-weight: 600;
            color: var(--text-dark);
            white-space: nowrap;
        }

        .restart-btn:hover,
        .restart-btn:active,
        .restart-btn:focus {
            width: auto;
            padding: 15px 20px;
            border-radius: 30px;
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 6px 20px rgba(255, 107, 157, 0.4);
        }

        .restart-btn:hover .restart-text,
        .restart-btn:active .restart-text,
        .restart-btn:focus .restart-text {
            display: inline;
        }

        .restart-btn.hidden {
            display: none;
        }

        .closing-footer-note {
            font-size: 0.9rem;
            margin-top: 20px;
            opacity: 0;
            font-weight: normal;
            font-style: italic;
        }

        #closingOverlay.active .closing-footer-note {
            animation: fadeIn 1s ease-out 2.3s both;
        }

        @media (max-width: 768px) {
            #introOverlay {
                z-index: 3000;
            }

            .restart-btn {
                width: 50px;
                height: 50px;
                top: 10px;
                left: 10px;
                padding: 12px;
            }

            .restart-btn:hover {
                padding: 12px 16px;
            }

            .audio-btn {
                width: 50px;
                height: 50px;
                top: 10px;
                right: 10px;
                padding: 12px;
            }

            .audio-btn:hover,
            .audio-btn:active,
            .audio-btn:focus {
                padding: 12px 16px;
            }

            .album-book {
                width: 300px;
                height: 380px;
            }

            .album-title {
                font-size: 2rem;
            }

            .prompt-text {
                font-size: 1.5rem;
            }

            .envelope {
                width: 280px;
                height: 200px;
            }

            .envelope-flap {
                border-left: 140px solid transparent;
                border-right: 140px solid transparent;
                border-top: 100px solid var(--accent-red);
            }

            .closing-title {
                font-size: 2rem;
            }

            .closing-text {
                font-size: 1.2rem;
            }

            .letter-paper {
                padding: 40px 20px;
            }

            .letter-paper h2 {
                font-size: 1.8rem;
            }

            .letter-paper .letter-content {
                font-size: 1rem;
            }
        }

        @media (max-width: 480px) {
            .slide {
                padding: 24px 16px 130px;
            }

            .album-title {
                font-size: 1.7rem;
            }

            .prompt-text {
                font-size: 1.3rem;
            }

            .timeline-slide {
                padding: 24px 16px 110px;
            }

            .timeline-photo {
                max-height: 220px;
            }

            .album-book {
                width: 240px;
                height: 320px;
            }

            .envelope {
                width: 240px;
                height: 170px;
            }

            .envelope-flap {
                border-left: 120px solid transparent;
                border-right: 120px solid transparent;
                border-top: 85px solid var(--accent-red);
            }

            .envelope-prompt {
                font-size: 1.2rem;
            }

            .closing-content {
                padding: 24px 18px 70px;
                gap: 6px;
            }

            .closing-title {
                font-size: 2.1rem;
                margin-bottom: 20px;
            }

            .closing-text {
                font-size: 1.1rem;
                margin-bottom: 14px;
            }

            .closing-hearts {
                font-size: 2.2rem;
                margin: 22px 0;
            }

            .closing-footer {
                font-size: 1.4rem;
                margin-bottom: 24px;
            }

            .replay-btn {
                padding: 12px 28px;
                font-size: 1rem;
            }

            .closing-meta {
                position: absolute;
                left: 50%;
                bottom: 8px;
                transform: translateX(-50%);
                margin-top: 0;
            }
        }

        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }

        /* ============================================
           TIMELOCK OVERLAY (Valentine's Day Lock)
           ============================================ */
        .lock-overlay {
            position: fixed;
            inset: 0;
            background: linear-gradient(135deg, #ff6b9d 0%, #ff1744 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            font-family: 'Georgia', serif;
            animation: fadeIn 0.6s ease;
        }

        .lock-overlay.hidden {
            display: none !important;
        }

        .lock-content {
            text-align: center;
            color: white;
            padding: 40px 30px;
            max-width: 500px;
        }

        .lock-icon {
            font-size: 100px;
            margin-bottom: 30px;
            animation: float 3s ease-in-out infinite;
        }

        .lock-content h1 {
            font-size: clamp(2rem, 5vw, 3.5rem);
            margin: 0 0 15px;
            font-weight: normal;
            letter-spacing: 1px;
        }

        .lock-content p {
            font-size: clamp(1rem, 2.5vw, 1.3rem);
            margin: 10px 0;
            opacity: 0.95;
            line-height: 1.6;
        }

        .countdown-text {
            font-size: clamp(0.95rem, 2.3vw, 1.15rem) !important;
            font-style: italic;
            margin-top: 20px !important;
            font-weight: normal;
        }

        .lock-status {
            margin-top: 20px;
            font-size: 0.95rem;
            opacity: 0.85;
        }

        .timelock-retry-btn {
            margin-top: 30px;
            padding: 14px 40px;
            font-size: 1.05rem;
            background: white;
            color: #ff6b9d;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 600;
            font-family: 'Georgia', serif;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .timelock-retry-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.4);
            background: #fff9fb;
        }

        .timelock-retry-btn:active {
            transform: translateY(0);
        }

        @media (max-width: 768px) {
            .lock-content {
                padding: 30px 20px;
            }

            .lock-icon {
                font-size: 80px;
                margin-bottom: 20px;
            }

            .lock-content h1 {
                font-size: 2rem;
            }

            .timelock-retry-btn {
                padding: 12px 35px;
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- ========================================
         BACKGROUND DECORATIONS
         ======================================== -->
    
    <!-- Floating Hearts Background -->
    <!-- Hearts are added dynamically by JavaScript -->
    <div class="heart-container" id="heartContainer"></div>

    <!-- Valentine's Day Lock Overlay -->
    <div id="lockOverlay" class="lock-overlay">
        <div class="lock-content">
            <div class="lock-icon">üíù</div>
            <h1>This is a Valentine's Day Gift</h1>
            <p>Come back on <strong>February 14</strong> to open our love timeline.</p>
            <div class="lock-status" id="lockStatus">Validating access...</div>
            <button class="timelock-retry-btn" onclick="initializeTimelock()">Check Again</button>
        </div>
    </div>

    <!-- ========================================
         INTRO OVERLAY (Album Cover)
         First screen user sees - clickable to start
         ======================================== -->
    
    <!-- Intro Page (Outside Slides) -->
    <div id="introOverlay" onclick="openAlbum()">
        <div class="album-container">
            <div class="intro-compact" onclick="openAlbum()">
                <div class="intro-compact-title">Our Story</div>
                <div class="intro-compact-heart">üíñ</div>
                <div class="intro-compact-text">Tap to begin</div>
            </div>
            <div class="album-book" onclick="openAlbum()">
                <div class="album-front">
                    <div class="album-title">Our Story</div>
                    <div class="photo-grid-mini">
                        <div class="mini-photo">
                            <img alt="Album photo 1">
                        </div>
                        <div class="mini-photo">
                            <img alt="Album photo 2">
                        </div>
                        <div class="mini-photo">
                            <img alt="Album photo 3">
                        </div>
                        <div class="mini-photo">
                            <img alt="Album photo 4">
                        </div>
                    </div>
                </div>
            </div>
            <div class="click-prompt">
                <span class="arrow-up">‚Üë</span>
                <span class="prompt-text">Tap the album to begin</span>
                <span class="arrow-up">‚Üë</span>
            </div>
        </div>
    </div>

    <!-- ========================================
         PHOTO LIGHTBOX
         Full-screen photo viewer with caption
         ======================================== -->
    
    <div class="photo-lightbox" id="photoLightbox">
        <button class="lightbox-close" onclick="closeLightbox()" aria-label="Close photo viewer">√ó</button>
        <button class="lightbox-nav prev hidden" onclick="navigateLightbox(-1)" aria-label="Previous photo">‚Äπ</button>
        <button class="lightbox-nav next hidden" onclick="navigateLightbox(1)" aria-label="Next photo">‚Ä∫</button>
        <div class="lightbox-photo-container">
            <img class="lightbox-photo" src="" alt="Photo">
            <div class="lightbox-caption"></div>
        </div>
    </div>

    <!-- ========================================
         MAIN SLIDESHOW
         Contains all 14 slides (March 2025 - February 2026)
         ======================================== -->
    
    <!-- Slideshow Container -->
    <div class="slideshow-container">
        <!-- Slide 0: March 2025 -->
        <div class="slide timeline-slide active">
            <div class="timeline-month">March 2025</div>
            <div class="message-bubble-card" aria-label="First messages">
                <div class="message-bubble-header">Aileen</div>
                <div class="message-bubble-stack">
                    <div class="message-bubble incoming">Hi</div>
                    <div class="message-bubble outgoing">Hello</div>
                </div>
            </div>
            <p class="timeline-text">It's a match! Remember our first chat? It was on your birthday üí¨</p>
        </div>

        <!-- Photo slides (April 2025 - January 2026) are generated dynamically from images.json -->

        <!-- Slide 11: February 2026 - Letter Envelope -->
        <div class="slide envelope-slide" id="envelopeSlide">
            <div class="envelope-container">
                <div class="envelope" id="envelope" onclick="toggleLetter()">
                    <div class="envelope-flap" id="envelopeFlap"></div>
                    <div class="envelope-body">
                        <div class="wax-seal">üíå</div>
                    </div>
                    <div class="letter-peek"></div>
                </div>
                <div class="envelope-prompt" id="envelopePrompt">
                    <p>A letter for you... ‚ù§Ô∏è</p>
                    <p style="font-size: 1rem; margin-top: 10px;">Click to open</p>
                </div>
                <div class="envelope-instruction">Tap the envelope to open üíå</div>
            </div>
        </div>
    </div>

    <!-- Letter Overlay (Outside Slideshow) -->
    <div class="letter-overlay" id="letterOverlay">
        <div class="letter-paper">
            <button class="close-letter-x" onclick="toggleLetter()">‚úï</button>
            <div class="letter-body">
                <h2>To My Dearest Aileen üíï</h2>
                <p class="letter-date">Valentine's Day 2026</p>
                <div class="letter-content">
                    <p>Hi Babe,</p>
                    
                    <p>Habang nandito ako ngayon at malayo ka man, pakiramdam ko mas malapit ka sa'kin kaysa dati.</p>
                    
                    <p>These past months proved kung gaano katatag yung meron tayo. Kahit distance, time zones, at screen lang pagitan ramdam kita palagi. Every call, every text, bawat good morning at good night‚Ä¶ importante lahat sa akin yun.</p>
                    
                    <p>Hindi madali ang LDR. May mga gabing gusto lang kitang yakapin at makasama in person. Pero dahil dito, mas lalo kong narealize kung gaano kita kamahal at kung gaano ako kasigurado sa iyo.</p>
                    
                    <p>Ikaw yung naging home ko, pag kausap kita, pag nakikita kita, pag iniisip ko future natin.</p>
                    
                    <p>Binibilang ko na lang araw hanggang magkita tayo ulit.</p>
                    
                    <p>Sana it will be sooner than later babe, so we can go back and feel each other's warmth again.</p>
                    
                    <p>Happy Valentine's Day, Babe.<br>
                    Miss na miss na kita. Mahal na mahal kita.</p>
                </div>
                <p class="letter-signature">Forever and always yours,<br>Patrick ‚ù§Ô∏è</p>
            </div>
        </div>
    </div>

    <!-- ========================================
         CLOSING OVERLAY (Final Screen)
         Shown after letter is closed
         ======================================== -->
    
    <!-- Closing Page (Outside Slideshow) -->
    <div id="closingOverlay">
        <div class="closing-carousel" aria-hidden="true"></div>
        <div class="closing-content">
            <h1 class="closing-title">Thank you for being mine ‚ù§Ô∏è</h1>
            <p class="closing-text">Every moment with you is a gift.</p>
            <p class="closing-text">Every day with you is an adventure.</p>
            <p class="closing-text">Every tomorrow with you is a promise.</p>
            <div class="closing-hearts">üíï üíù üíñ üíó üíì</div>
            <p class="closing-footer">Happy Valentine's Day, babe!</p>
            <button class="replay-btn" onclick="restartJourney()">Relive Our Journey ‚Üí</button>
            <p class="closing-footer-note">(Or you can close this page... but I hope you don't ‚ù§Ô∏è)</p>
            <p class="closing-meta" style="font-size:0.8rem;opacity:0.7;margin-top:16px;">Built by Patrick Jove ‚Ä¢ AI assisted using GitHub Copilot</p>
        </div>
    </div>

    <!-- ========================================
         NAVIGATION CONTROLS
         Buttons that control slideshow navigation
         ======================================== -->
    
    <!-- Restart Button (Top-Left) -->
    <button class="restart-btn hidden" id="restartBtn" onclick="restartJourney()" title="Restart Journey">
        <span class="restart-icon">üíñ</span>
        <span class="restart-text">Restart</span>
    </button>

    <!-- Navigation Arrows (Left/Right sides) -->
    <button class="nav-arrow prev" onclick="prevSlide()">‚Äπ</button>  <!-- Left arrow -->
    <button class="nav-arrow next" onclick="nextSlide()">‚Ä∫</button>  <!-- Right arrow -->

    <!-- ========================================
         TIMELINE SLIDER (Bottom of screen)
         Dots representing each month - click to jump
         ======================================== -->
    
    <!-- Timeline Slider at Bottom -->
    <div class="timeline-slider">
        <div class="slider-track" id="sliderTrack">
            <div class="timeline-dot intro" data-slide="-1" onclick="goToIntro()">
                <span>Start</span>
            </div>
            <div class="timeline-dot" data-slide="0" onclick="goToSlide(event,0)">
                <span>Mar<br>2025</span>
            </div>
            <div class="timeline-dot" data-slide="1" onclick="goToSlide(event,1)">
                <span>Apr<br>2025</span>
            </div>
            <div class="timeline-dot" data-slide="2" onclick="goToSlide(event,2)">
                <span>May<br>2025</span>
            </div>
            <div class="timeline-dot" data-slide="3" onclick="goToSlide(event,3)">
                <span>Jun<br>2025</span>
            </div>
            <div class="timeline-dot" data-slide="4" onclick="goToSlide(event,4)">
                <span>Jul<br>2025</span>
            </div>
            <div class="timeline-dot" data-slide="5" onclick="goToSlide(event,5)">
                <span>Aug<br>2025</span>
            </div>
            <div class="timeline-dot" data-slide="6" onclick="goToSlide(event,6)">
                <span>Sep<br>2025</span>
            </div>
            <div class="timeline-dot" data-slide="7" onclick="goToSlide(event,7)">
                <span>Oct<br>2025</span>
            </div>
            <div class="timeline-dot" data-slide="8" onclick="goToSlide(event,8)">
                <span>Nov<br>2025</span>
            </div>
            <div class="timeline-dot" data-slide="9" onclick="goToSlide(event,9)">
                <span>Dec<br>2025</span>
            </div>
            <div class="timeline-dot" data-slide="10" onclick="goToSlide(event,10)">
                <span>Jan<br>2026</span>
            </div>
            <div class="timeline-dot letter-dot hidden" id="letterDot" data-slide="11" onclick="goToSlide(event,11)">
                <span>Feb<br>2026<br>üíå</span>
            </div>
        </div>
    </div>

    <!-- ========================================
         AUDIO CONTROLS (Top-Right)
         Music button with play/pause
         ======================================== -->
    
    <!-- Audio Controls -->
    <button class="audio-btn" id="audioToggle" onclick="toggleAudio()">
        <span class="audio-icon">üéµ</span>
        <span class="audio-text">
            <span class="audio-song">Enchanted (Taylor Swift cover)</span>
            <span class="audio-play">‚ñ∂Ô∏è</span>
        </span>
    </button>
    <audio id="audioPlayer" src="assets/audio/enchanted.mp3" preload="metadata" loop></audio>

    <!-- Transition overlay used for smooth restart fade -->
    <div id="transitionOverlay" style="position:fixed;inset:0;background:#fff;opacity:0;pointer-events:none;z-index:4000;transition:opacity 0.45s ease"></div>

    <!-- ============================================
         JAVASCRIPT CODE - Makes the page interactive
         ============================================ -->
    <script>
        /* ========================================
           VALENTINE'S DAY TIMELOCK (Security)
           Validates internet time & location before unlocking
           ======================================== */

        /**
         * Main timelock initialization function
         * Validates time and location, then unlocks or locks the app
         */
        async function initializeTimelock() {
            const lockOverlay = document.getElementById('lockOverlay');
            const lockStatus = document.getElementById('lockStatus');
            
            if (!lockOverlay) return;

            try {
                lockStatus.textContent = 'Validating access...';
                
                // Fetch official server time (tamper-proof)
                let serverTime = await fetchServerTime();
                if (!serverTime) {
                    showLocked('No internet connection detected. Please connect to the internet.', lockOverlay, lockStatus);
                    return;
                }

                // Get user's timezone from browser
                const userTimezone = Intl.DateTimeFormat().resolvedOptions().timeZone;

                // Try to validate location (optional)
                try {
                    const location = await getLocationWithFallback();
                    console.log('üìç User Location:', {
                        source: location.source,
                        latitude: location.lat,
                        longitude: location.lon,
                        country: location.country || 'N/A',
                        timezone: location.timezone || userTimezone
                    });
                } catch (e) {
                    console.log('Location validation skipped:', e.message);
                    // Continue without location - time validation is the main check
                }

                // Get and log timezone
                console.log('üåç User Timezone:', userTimezone);

                // Check if current time >= Feb 14, 2026 midnight in user's timezone
                const unlockDateTime = new Date('2026-02-14T00:00:00');
                
                // Convert server time to user's timezone
                const userTime = new Date(serverTime.toLocaleString('en-US', { timeZone: userTimezone }));

                if (userTime >= unlockDateTime) {
                    // UNLOCKED! Hide lock overlay and show app
                    lockOverlay.classList.add('hidden');
                    lockStatus.textContent = 'Access granted! ‚ú®';
                    return true;
                } else {
                    // Still locked
                    const daysLeft = Math.ceil((unlockDateTime - userTime) / (1000 * 60 * 60 * 24));
                    const message = `Get ready to celebrate! ${daysLeft} days to go üíï`;
                    showLocked(message, lockOverlay, lockStatus);
                    return false;
                }

            } catch (error) {
                console.error('Timelock error:', error);
                showLocked('Unable to validate. Please check your internet connection.', lockOverlay, lockStatus);
                return false;
            }
        }

        /**
         * Fetch server time from multiple APIs for redundancy
         * Returns Date object or null if all fail
         */
        async function fetchServerTime() {
            const apis = [
                // timeapi.io - CORS-friendly
                { url: 'https://timeapi.io/api/Time/current/zone?timeZone=Etc/UTC', parser: (data) => new Date(data.dateTime) },
                // GitHub API - includes server time in headers
                { url: 'https://api.github.com', parser: (data, headers) => new Date(headers.get('date')) },
                // Alternative: ipapi.co includes time
                { url: 'https://ipapi.co/json/', parser: (data) => data.datetime ? new Date(data.datetime) : null }
            ];

            for (const api of apis) {
                try {
                    const response = await fetch(api.url, { 
                        method: 'GET',
                        cache: 'no-store',
                        headers: { 'Accept': 'application/json' }
                    });
                    
                    if (!response.ok) continue;

                    let time;
                    if (api.url.includes('github')) {
                        // GitHub returns time in headers
                        time = api.parser(null, response.headers);
                    } else {
                        const data = await response.json();
                        time = api.parser(data);
                    }
                    
                    if (time && time instanceof Date && !isNaN(time)) {
                        console.log('‚úì Server time fetched successfully from:', api.url);
                        return time;
                    }
                } catch (e) {
                    console.log(`Failed to fetch from ${api.url}:`, e.message);
                    continue;
                }
            }

            console.warn('‚ö†Ô∏è All time APIs failed. Please check your internet connection.');
            return null; // All APIs failed
        }

        /**
         * Get user location via browser geolocation or IP fallback
         * Used for extra security (optional, not blocking)
         */
        async function getLocationWithFallback() {
            return new Promise((resolve, reject) => {
                // Try browser geolocation first (no permission = deny access to IP lookup)
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(
                        (position) => {
                            console.log('Browser location obtained');
                            resolve({
                                source: 'browser',
                                lat: position.coords.latitude,
                                lon: position.coords.longitude
                            });
                        },
                        async (error) => {
                            console.log('Geolocation denied, trying IP lookup...');
                            
                            // Fallback to IP-based geolocation
                            try {
                                const response = await fetch('https://ipapi.co/json/', {
                                    cache: 'no-store'
                                });
                                const data = await response.json();
                                
                                console.log('IP location obtained:', data.country_name);
                                resolve({
                                    source: 'ip',
                                    lat: data.latitude,
                                    lon: data.longitude,
                                    country: data.country_name,
                                    timezone: data.timezone
                                });
                            } catch (e) {
                                console.log('IP lookup failed:', e.message);
                                reject(e);
                            }
                        },
                        {
                            timeout: 5000,
                            maximumAge: 0
                        }
                    );
                } else {
                    reject(new Error('Geolocation not supported'));
                }
            });
        }

        /**
         * Show locked overlay with message
         */
        function showLocked(message, lockOverlay, lockStatus) {
            lockOverlay.classList.remove('hidden');
            lockStatus.textContent = message;
        }

        /* ========================================
           GLOBAL VARIABLES (STATE)
           These track the current state of the app
           ======================================== */
        
        let currentSlide = 0;           // Which slide is currently showing (0-13)
        let slides = document.querySelectorAll('.slide');           // Get all slide elements from HTML
        const timelineDots = document.querySelectorAll('.timeline-dot');  // Get all timeline dot elements
        let showingIntro = true;        // Is the intro overlay visible? (true at start)
        let isAudioPlaying = false;     // Is the audio playing? (for play/pause icon)
        
        // Photo lightbox state
        let lightboxOpen = false;       // Is the photo lightbox currently open?
        let currentLightboxSlideIndex = 0;  // Which slide's photos are being viewed
        let currentPhotoIndex = 0;      // Which photo within the slide is being viewed
        let slidePhotoData = {};        // Stores loaded photo data from JSON {slideIndex: [{src, caption}, ...]}

        /* ========================================
           FLOATING HEARTS BACKGROUND
           Creates decorative hearts that float up
           ======================================== */
        
        /**
         * Creates a single floating heart element
         * - Adds a heart emoji to the heart container
         * - Gives it random position and animation timing
         * - Auto-removes after HEART_CLEANUP_DELAY to prevent memory leaks
         * - Respects MAX_CONCURRENT_HEARTS limit to prevent DOM bloat
         */
        function createHeart() {
            // Check heart count - don't create if too many exist
            const heartContainer = cachedElements.heartContainer || document.getElementById('heartContainer');
            const existingHearts = heartContainer.querySelectorAll('.heart').length;
            
            if (existingHearts >= MAX_CONCURRENT_HEARTS) {
                if (DEBUG) console.log('‚ö†Ô∏è Max concurrent hearts reached:', MAX_CONCURRENT_HEARTS);
                return;  // Don't create more
            }
            
            const heart = document.createElement('div');
            heart.classList.add('heart');
            heart.innerHTML = '‚ù§Ô∏è';
            
            // Random horizontal position (0-100% of screen width)
            heart.style.left = Math.random() * 100 + '%';
            
            // Random animation duration (5-10 seconds)
            heart.style.animationDuration = (Math.random() * 5 + 5) + 's';
            
            // Random start delay (0-5 seconds)
            heart.style.animationDelay = Math.random() * 5 + 's';
            
            heartContainer.appendChild(heart);

            // Remove heart after animation completes
            setTimeout(() => {
                heart.remove();
            }, HEART_CLEANUP_DELAY);
        }

        // Start creating hearts: 1 heart every 2 seconds
        setInterval(createHeart, 2000);
        
        // Create 5 initial hearts immediately (staggered by 0.5s each)
        for (let i = 0; i < 5; i++) {
            setTimeout(createHeart, i * 500);
        }

        /* ========================================
           NAVIGATION SYSTEM
           Core function that switches between slides
           ======================================== */
        
        /**
         * Shows a specific slide with animation
         * This is the MAIN navigation function called by all other navigation methods
         * 
         * @param {number} index - Which slide to show (0-13)
         * @param {string} direction - Animation type:
         *   - 'next'  = sliding left (going forward)
         *   - 'prev'  = sliding right (going backward)
         *   - 'fade'  = fade in/out (used for final slide and timeline jumps)
         *   - 'endReveal' = special animation for letter closing
         *   - 'none'  = no animation
         */
        function showSlide(index, direction = 'none') {
            // Special case: Final slide defaults to fade animation
            if (index === slides.length - 1 && direction === 'none') {
                direction = 'fade';
            }
            
            // Boundary checks: Don't go below 0 or above max
            if (index < 0) {
                currentSlide = 0;
                return;
            } else if (index >= slides.length) {
                currentSlide = slides.length - 1;
                return;
            }

            // Store which slide we're leaving
            const previousSlide = currentSlide;
            
            // Update current slide index
            currentSlide = index;
            
            // We're no longer showing the intro
            showingIntro = false;

            // Loop through ALL slides to update their states
            slides.forEach((slide, i) => {
                // First, remove all animation classes from every slide (clean slate)
                slide.classList.remove('active', 'slide-out-left', 'slide-out-right', 'slide-in-right');
                
                // If this is the slide we're LEAVING, animate it out
                if (i === previousSlide && direction !== 'none') {
                    // Choose exit animation based on direction
                    if (direction === 'next') {
                        slide.classList.add('slide-out-left');  // Slide out to the left
                    } else if (direction === 'prev') {
                        slide.classList.add('slide-out-right');  // Slide out to the right
                    } else if (direction === 'fade') {
                        slide.classList.add('fade-out');  // Fade out
                    }
                    
                    // Clean up animation classes after animation completes (650ms)
                    setTimeout(() => {
                        slide.classList.remove('slide-out-left', 'slide-out-right', 'fade-out');
                    }, 650);  // Must match CSS animation duration
                }
                
                // If this is the slide we're ENTERING, make it active and animate it in
                if (i === currentSlide) {
                    // If we're doing a fade or endReveal, avoid the default slide-in animation
                    if (direction === 'fade') {
                        slide.classList.add('active', 'no-slide');
                        slide.classList.add('fade-in');
                        setTimeout(() => {
                            slide.classList.remove('fade-in');
                            slide.classList.remove('no-slide');
                        }, 650);
                        if (currentSlide === 0) {
                            slide.classList.add('first-enter');
                            setTimeout(() => slide.classList.remove('first-enter'), 1300);
                        }
                    } else if (direction === 'endReveal') {
                        slide.classList.add('active');
                        slide.classList.add('end-reveal-in');
                        setTimeout(() => {
                            slide.classList.remove('end-reveal-in');
                        }, 700);
                    } else {
                        slide.classList.add('active', 'slide-in-right');
                        setTimeout(() => {
                            slide.classList.remove('slide-in-right');
                        }, 650);
                    }
                }
            });

            timelineDots.forEach((dot, i) => {
                dot.classList.remove('active');
            });
            
            // Show/hide letter dot (Feb 2026) when reaching January (slide 10)
            const letterDot = document.getElementById('letterDot');
            if (currentSlide >= 10) {
                letterDot.classList.remove('hidden');
                // Add glowing effect to letter dot when on February envelope (slide 11)
                if (currentSlide === 11) {
                    letterDot.classList.add('glowing');
                } else {
                    letterDot.classList.remove('glowing');
                }
            } else {
                letterDot.classList.add('hidden');
                letterDot.classList.remove('glowing');
            }
            
            // Timeline slider and buttons visibility
            const timelineSlider = document.querySelector('.timeline-slider');
            const navArrows = document.querySelectorAll('.nav-arrow');
            const restartBtn = document.getElementById('restartBtn');
            
            // Hide timeline and buttons on envelope slide (slide 11)
            if (currentSlide === 11 || timelineSlider.classList.contains('disabled')) {
                timelineSlider.classList.add('hidden');
                restartBtn.classList.add('hidden');
            } else {
                timelineSlider.classList.remove('hidden');
                restartBtn.classList.remove('hidden');
            }

            // Hide navigation arrows on the envelope slide
            if (currentSlide === 11) {
                navArrows.forEach(arrow => arrow.classList.add('hidden'));
                // Add animation to envelope when it's the active slide
                const envelope = document.getElementById('envelope');
                if (envelope) {
                    envelope.classList.add('active');
                }
            } else {
                navArrows.forEach(arrow => arrow.classList.remove('hidden'));
                // Remove animation from envelope when not on letter slide
                const envelope = document.getElementById('envelope');
                if (envelope) {
                    envelope.classList.remove('active');
                }
            }
            
            // Correctly map current slide to timeline dot using data-slide
            const activeDot = document.querySelector(`.timeline-dot[data-slide="${currentSlide}"]`);
            if (activeDot) {
                activeDot.classList.add('active');
                // Prefer precise centering inside the scrollable track so mobile shows the active month centered.
                const sliderTrack = document.getElementById('sliderTrack');
                if (sliderTrack && !sliderTrack.classList.contains('hidden')) {
                    requestAnimationFrame(() => {
                        const trackRect = sliderTrack.getBoundingClientRect();
                        const dotRect = activeDot.getBoundingClientRect();
                        const delta = (dotRect.left - trackRect.left) - (trackRect.width / 2 - dotRect.width / 2);
                        sliderTrack.scrollBy({ left: delta, behavior: 'smooth' });
                    });
                } else {
                    activeDot.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
                }
            }

            // Update arrow visibility (hide prev on first slide, hide next on last)
            const prevArrow = document.querySelector('.nav-arrow.prev');
            const nextArrow = document.querySelector('.nav-arrow.next');
            
            // Hide left arrow on first slide (can't go back further)
            if (currentSlide === 0) {
                prevArrow.classList.add('hidden');
            } else {
                prevArrow.classList.remove('hidden');
            }
            
            // Hide right arrow on last slide (end of slideshow)
            if (currentSlide === slides.length - 1) {
                nextArrow.classList.add('hidden');
            } else {
                nextArrow.classList.remove('hidden');
            }
        }  // End of showSlide function

        /* ========================================
           NAVIGATION HELPER FUNCTIONS
           Simple wrappers that call showSlide()
           ======================================== */
        
        /**
         * Go to next slide (called by right arrow, right swipe, right keyboard arrow)
         */
        function nextSlide() {
            showSlide(currentSlide + 1, 'next');  // Increment index, animate left
        }

        /**
         * Go to previous slide (called by left arrow, left swipe, left keyboard arrow)
         */
        function prevSlide() {
            showSlide(currentSlide - 1, 'prev');  // Decrement index, animate right
        }

        /**
         * Jump directly to a specific slide (called by timeline dots)
         * @param {Event|number} e - Event object or slide index
         * @param {number} index - Slide index (if e is an event)
         */
        function goToSlide(e, index) {
            // support calls without event (legacy)
            if (typeof e === 'number') {
                index = e;
                e = null;
            }

            // determine direction based on pointer position if available
            let direction = index > currentSlide ? 'next' : 'prev';
            if (e && e.clientX !== undefined) {
                const rect = e.currentTarget ? e.currentTarget.getBoundingClientRect() : e.target.getBoundingClientRect();
                const centerX = rect.left + rect.width / 2;
                const clickX = e.touches ? e.touches[0].clientX : e.clientX;
                direction = clickX > centerX ? 'next' : 'prev';
            }

            showSlide(index, direction);  // Jump to the selected slide
        }

        /* ========================================
           KEYBOARD NAVIGATION
           Arrow keys for desktop users
           ======================================== */
        
        // Listen for keyboard arrow presses
        document.addEventListener('keydown', (e) => {
            // Block navigation when lightbox is open
            if (lightboxOpen) {
                if (e.key === 'Escape') {
                    closeLightbox();
                } else if (e.key === 'ArrowLeft') {
                    navigateLightbox(-1);
                } else if (e.key === 'ArrowRight') {
                    navigateLightbox(1);
                }
                return;
            }
            
            // Disable keyboard navigation when letter overlay is active or on envelope slide (last slide)
            const letterOverlay = document.getElementById('letterOverlay');
            if (letterOverlay && letterOverlay.classList.contains('active')) {
                return; // Block all keyboard interaction when letter is open
            }
            if (currentSlide === 11) {
                return; // Block all keyboard interaction on final envelope slide
            }
            
            // Block forward navigation is not needed since envelope is last slide
            
            // Check which arrow key was pressed
            if (e.key === 'ArrowLeft') {
                prevSlide();  // Left arrow = previous slide
            } else if (e.key === 'ArrowRight') {
                nextSlide();  // Right arrow = next slide
            }
        });

        /* ========================================
           PHOTO LIGHTBOX FUNCTIONS
           Handle full-screen photo viewer
           ======================================== */
        
        /**
         * Opens the lightbox with a specific photo
         * @param {number} slideIndex - Which slide (1-11) the photo belongs to
         * @param {number} photoIndex - Which photo within that slide (0-based)
         */
        function openLightbox(slideIndex, photoIndex) {
            const photos = slidePhotoData[slideIndex];
            if (!photos || !photos[photoIndex]) return;
            
            lightboxOpen = true;
            currentLightboxSlideIndex = slideIndex;
            currentPhotoIndex = photoIndex;
            
            const lightbox = document.getElementById('photoLightbox');
            const photo = lightbox.querySelector('.lightbox-photo');
            const caption = lightbox.querySelector('.lightbox-caption');
            const prevBtn = lightbox.querySelector('.lightbox-nav.prev');
            const nextBtn = lightbox.querySelector('.lightbox-nav.next');
            
            // Load photo and caption
            photo.src = normalizeImagePath(photos[photoIndex].src);
            caption.textContent = photos[photoIndex].caption || '';
            
            // Show/hide navigation arrows
            if (photos.length > 1) {
                prevBtn.classList.toggle('hidden', photoIndex === 0);
                nextBtn.classList.toggle('hidden', photoIndex === photos.length - 1);
            } else {
                prevBtn.classList.add('hidden');
                nextBtn.classList.add('hidden');
            }
            
            lightbox.classList.add('active');
        }
        
        /**
         * Closes the lightbox
         */
        function closeLightbox() {
            lightboxOpen = false;
            const lightbox = document.getElementById('photoLightbox');
            lightbox.classList.remove('active');
        }
        
        /**
         * Navigate between photos in the lightbox
         * @param {number} direction - -1 for previous, 1 for next
         */
        function navigateLightbox(direction) {
            const photos = slidePhotoData[currentLightboxSlideIndex];
            if (!photos) return;
            
            const newIndex = currentPhotoIndex + direction;
            if (newIndex >= 0 && newIndex < photos.length) {
                openLightbox(currentLightboxSlideIndex, newIndex);
            }
        }

        /* ========================================
           TOUCH SWIPE NAVIGATION
           Swipe left/right for mobile users
           ======================================== */
        
        let touchStartX = 0;  // Where finger started
        let touchEndX = 0;    // Where finger ended

        // Record where the touch started
        document.addEventListener('touchstart', (e) => {
            touchStartX = e.changedTouches[0].screenX;
        });

        // When touch ends, check if it was a swipe
        document.addEventListener('touchend', (e) => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();  // Process the swipe
        });

        /**
         * Determines if touch was a swipe and which direction
         * Requires minimum 50px movement to count as a swipe
         */
        function handleSwipe() {
            // Block swipe navigation when lightbox is open
            if (lightboxOpen) {
                // Allow horizontal swipe in lightbox for photo navigation
                if (touchEndX < touchStartX - 50) {
                    navigateLightbox(1); // Swipe left = next photo
                } else if (touchEndX > touchStartX + 50) {
                    navigateLightbox(-1); // Swipe right = previous photo
                }
                return;
            }
            
            // Disable swipe navigation when letter overlay is active or on envelope slide (last slide)
            const letterOverlay = document.getElementById('letterOverlay');
            if (letterOverlay && letterOverlay.classList.contains('active')) {
                return; // Block all swipe interaction when letter is open
            }
            if (currentSlide === 11) {
                return; // Block all swipe interaction on final envelope slide
            }
            
            // Block forward swipe is not needed since envelope is last slide
            
            // Calculate swipe distance
            if (touchEndX < touchStartX - 50) {      // Swiped left (move forward)
                nextSlide();
            }
            if (touchEndX > touchStartX + 50) {      // Swiped right (move backward)
                prevSlide();
            }
        }

        /* ========================================
           AUDIO CONTROLS
           Mock play/pause interaction
           ======================================== */
        
        /**
         * Toggles the play/pause icon in the music button
         * Note: This is mock functionality - no actual audio playback
         */
        /**
         * Toggles the play/pause icon in the music button
         * Uses cached audio player for better performance
         */
        function toggleAudio() {
            const playPauseIcon = document.querySelector('.audio-play');
            const audioPlayer = cachedElements.audioPlayer || document.getElementById('audioPlayer');
            if (!playPauseIcon) return;

            if (audioPlayer) {
                if (audioPlayer.paused) {
                    audioPlayer.play().catch(() => {
                        // Playback can fail without user interaction or missing file
                    });
                } else {
                    audioPlayer.pause();
                }
                isAudioPlaying = !audioPlayer.paused;
            } else {
                isAudioPlaying = !isAudioPlaying;
            }

            // Update icon: if playing show pause (‚è∏Ô∏è), if paused show play (‚ñ∂Ô∏è)
            playPauseIcon.textContent = isAudioPlaying ? '‚è∏Ô∏è' : '‚ñ∂Ô∏è';
        }

        /* ========================================
           SPECIAL EFFECTS
           ======================================== */

        /* ========================================
           INTRO/OUTRO CONTROLS
           Show/hide the album cover intro screen
           ======================================== */
        
        /**
         * Hides the intro overlay and shows the first slide
         * Called when user clicks the album cover
         */
        function openAlbum() {
            const introOverlay = document.getElementById('introOverlay');
            
            // Prevent multiple clicks
            if (introOverlay.classList.contains('exit') || introOverlay.classList.contains('hidden')) {
                return;  // Already closing or closed
            }
            
            introOverlay.classList.add('exit');  // Trigger fade-out animation
            showingIntro = false;  // Update state
            
            // Auto-play audio when user opens the album
            const audioPlayer = document.getElementById('audioPlayer');
            const playPauseIcon = document.querySelector('.audio-play');
            if (audioPlayer) {
                audioPlayer.play().catch(() => {
                    // Playback may fail if browser requires user interaction or file is missing
                });
                isAudioPlaying = true;
                if (playPauseIcon) playPauseIcon.textContent = '‚è∏Ô∏è';
            }
            
            // Wait for intro to fade out (650ms), then show first slide
            setTimeout(() => showSlide(0, 'fade'), 650);
        }

        /**
         * Checks if device is in landscape mode on a small screen
         * Adds 'landscape-compact' class to body for special layout
         * Called on page load and whenever window is resized
         */
        /**
         * Checks if device is in landscape mode on a small screen
         * Adds 'landscape-compact' class to body for special layout
         * Called on page load and whenever window is resized
         */
        function updateIntroCompactMode() {
            // matchMedia checks if screen matches the condition (like CSS media query)
            const compactQuery = window.matchMedia('(orientation: landscape) and (max-height: 700px)');
            
            // If matches, add class; if not, remove it
            document.body.classList.toggle('landscape-compact', compactQuery.matches);
        }

        /* ========================================
           INITIALIZATION
           Code that runs when page first loads
           ======================================== */
        
        // Wait for HTML to fully load before running JavaScript
        /* ========================================
           DYNAMIC SLIDE GENERATION
           Generates photo slides from JSON data
           ======================================== */
        
        /**
         * Generates scrapbook photo galleries for photo slides (1-11)
         * Skips slide 0 (March message bubbles) which is manually defined
         */
        /**
         * Placeholder - actual implementation is further down
         */

        document.addEventListener('DOMContentLoaded', function() {
            const introOverlay = document.getElementById('introOverlay');
            if (introOverlay) {
                // Prevent double-tap zoom on intro
                let lastTouchEnd = 0;
                introOverlay.addEventListener('touchend', function(e) {
                    const now = Date.now();
                    if (now - lastTouchEnd <= 300) {
                        e.preventDefault();
                    }
                    lastTouchEnd = now;
                }, false);
            }
            setupImageFallbacks();
            loadImagePool().then((pool) => {
                startAlbumShuffle(pool);
                startClosingCarousel(pool);
                generatePhotoSlides(); // Generate dynamic photo slides after JSON loaded
            });
            updateIntroCompactMode();  // Check if we need compact mode
        });

        // Re-check compact mode whenever window is resized (rotation, browser resize)
        window.addEventListener('resize', updateIntroCompactMode);

        /**
         * Returns to the intro screen
         * Called by the restart button
         */
        /**
         * Returns to the intro screen
         * Called by the restart button
         */
        function goToIntro() {
            const introOverlay = document.getElementById('introOverlay');
            introOverlay.classList.remove('exit', 'hidden');  // Show intro again
            showingIntro = true;  // Update state
            
            // Hide all slides and remove all animation classes
            slides.forEach((slide) => {
                slide.classList.remove('active', 'slide-in-right', 'slide-out-left', 'slide-out-right', 'fade-in', 'fade-out');
            });
        }

        function setupImageFallbacks() {
            const images = document.querySelectorAll('.timeline-photo');
            images.forEach((img) => {
                img.addEventListener('error', () => {
                    const placeholder = document.createElement('div');
                    placeholder.className = 'timeline-photo timeline-photo-placeholder';
                    placeholder.setAttribute('data-alt', img.alt || 'Photo coming soon');
                    img.replaceWith(placeholder);
                });
            });

            const miniImages = document.querySelectorAll('.mini-photo img');
            miniImages.forEach((img) => {
                img.addEventListener('load', () => {
                    const wrapper = img.parentElement;
                    if (!wrapper) return;
                    wrapper.classList.remove('placeholder');
                    img.style.display = 'block';
                    img.style.opacity = '1';
                });
                img.addEventListener('error', () => {
                    const wrapper = img.parentElement;
                    if (!wrapper) return;
                    img.style.display = 'none';
                });
            });
        }

        function getDefaultImagePool() {
            return [
                'assets/images/month-03-1.jpg',
                'assets/images/month-04-1.jpg',
                'assets/images/month-05-1.png',
                'assets/images/month-06-1.png',
                'assets/images/month-07-1.png',
                'assets/images/month-08-1.png',
                'assets/images/month-09-1.png',
                'assets/images/month-10-1.jpg',
                'assets/images/month-11-1.png'
            ];
        }

        function normalizeImagePath(path) {
            if (typeof path !== 'string') return '';
            if (path.includes('/')) return path;
            return `assets/images/${path}`;
        }

        function normalizeImagePool(pool) {
            if (!Array.isArray(pool) || pool.length === 0) {
                return getDefaultImagePool();
            }

            return pool.map((item) => {
                if (typeof item !== 'string') return null;
                return normalizeImagePath(item);
            }).filter(Boolean);
        }

        function buildPoolFromSlides(slidesData) {
            if (!slidesData || typeof slidesData !== 'object') return [];
            const pool = [];
            Object.values(slidesData).forEach((photos) => {
                if (!Array.isArray(photos)) return;
                photos.forEach((photo) => {
                    if (photo && typeof photo.src === 'string') {
                        pool.push(normalizeImagePath(photo.src));
                    }
                });
            });
            return pool.filter(Boolean);
        }

        function loadImagePool() {
            return fetch('assets/images.json', { cache: 'no-store' })
                .then((response) => {
                    if (!response.ok) throw new Error('Failed to load images.json');
                    return response.json();
                })
                .then((data) => {
                    // Handle new JSON structure with 'slides' and 'carousel' keys
                    if (data && typeof data === 'object') {
                        // Store slide photo data globally
                        if (data.slides) {
                            slidePhotoData = data.slides;
                        }
                        
                        // Return carousel images for album shuffle
                        if (Array.isArray(data.carousel)) {
                            return normalizeImagePool(data.carousel);
                        }

                        // Fallback: build a pool from slide photos
                        if (data.slides) {
                            const slidePool = buildPoolFromSlides(data.slides);
                            if (slidePool.length > 0) return slidePool;
                        }
                        
                        // Fallback: if it's still the old array format
                        if (Array.isArray(data)) {
                            return normalizeImagePool(data);
                        }
                    }
                    return getDefaultImagePool();
                })
                .catch(() => getDefaultImagePool());
        }

        function startAlbumShuffle(imagePool) {
            const miniImages = Array.from(document.querySelectorAll('.mini-photo img'));
            if (miniImages.length === 0) return;

            const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)');
            if (prefersReducedMotion.matches) return;

            const pool = normalizeImagePool(imagePool);

            const shuffle = (list) => {
                const copy = list.slice();
                for (let i = copy.length - 1; i > 0; i -= 1) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [copy[i], copy[j]] = [copy[j], copy[i]];
                }
                return copy;
            };

            const updateMiniPhotos = () => {
                let picks = shuffle(pool);
                while (picks.length < miniImages.length) {
                    picks = picks.concat(shuffle(pool));
                }
                picks = picks.slice(0, miniImages.length);
                miniImages.forEach((img, index) => {
                    const wrapper = img.parentElement;
                    img.style.opacity = '0';
                    setTimeout(() => {
                        img.src = picks[index];
                        img.style.display = 'block';
                        if (wrapper) wrapper.classList.remove('placeholder');
                        if (img.complete) {
                            requestAnimationFrame(() => {
                                img.style.opacity = '1';
                            });
                        }
                    }, 180);
                });
            };

            updateMiniPhotos();
            setInterval(updateMiniPhotos, 4000);
        }

        /* ========================================
           GENERATE PHOTO SLIDES FROM JSON
           Creates dynamic slides with scrapbook galleries
           ======================================== */
        
        function generatePhotoSlides() {
            const slideshowContainer = document.querySelector('.slideshow-container');
            if (!slideshowContainer) return;
            
            // Month names for slide titles
            const monthNames = [
                'March 2025',  // 0
                'April 2025',  // 1
                'May 2025',    // 2
                'June 2025',   // 3
                'July 2025',   // 4
                'August 2025', // 5
                'September 2025', // 6
                'October 2025',   // 7
                'November 2025',  // 8
                'December 2025',  // 9
                'January 2026',   // 10
                'February 2026'   // 11
            ];
            
            // Get all existing slides and keep track of special slides
            const existingSlides = Array.from(slideshowContainer.querySelectorAll('.slide'));
            const marchSlide = existingSlides[0]; // Keep March message bubble slide
            const envelopeSlide = slideshowContainer.querySelector('.envelope-slide');
            
            // Clear container and re-add March slide first (keeping it active)
            slideshowContainer.innerHTML = '';
            if (marchSlide) {
                marchSlide.classList.add('active'); // Ensure March is active by default
                slideshowContainer.appendChild(marchSlide);
            }
            
            // Slide 1: April 2025 (chat bubbles)
            const aprilSlide = document.createElement('div');
            aprilSlide.className = 'slide timeline-slide';
            aprilSlide.innerHTML = `
                <div class="timeline-month">${monthNames[1]}</div>
                <div class="message-bubble-card" aria-label="First meeting">
                    <div class="message-bubble-header">Aileen</div>
                    <div class="message-bubble-stack">
                        <div class="message-bubble outgoing">tara let's meet?</div>
                        <div class="message-bubble incoming">sure</div>
                        <div class="message-bubble outgoing">see you!</div>
                    </div>
                </div>
                <p class="timeline-text">Our first meeting. Kaba at saya naramdaman ko dahil di ko alam ang susunod na pangyayari... ü´£</p>
            `;
            slideshowContainer.appendChild(aprilSlide);
            
            // Generate photo slides (indices 2-10: May 2025 - January 2026)
            for (let i = 2; i <= 10; i++) {
                const photos = slidePhotoData[i];
                if (!photos || photos.length === 0) continue;
                
                const slideDiv = document.createElement('div');
                slideDiv.className = 'slide timeline-slide';
                // Don't add active class - March should be the active slide
                
                // Create month title
                const monthDiv = document.createElement('div');
                monthDiv.className = 'timeline-month';
                monthDiv.textContent = monthNames[i];
                slideDiv.appendChild(monthDiv);
                
                // Create photo gallery
                const galleryDiv = document.createElement('div');
                galleryDiv.className = 'photo-gallery';
                if (photos.length === 1) {
                    galleryDiv.classList.add('single-photo');
                } else if (photos.length >= 5) {
                    galleryDiv.classList.add('many-photos');
                }
                
                // Add photos to gallery
                photos.forEach((photoData, photoIndex) => {
                    const photoWrapper = document.createElement('div');
                    photoWrapper.className = 'scrapbook-photo';
                    const normalizedSrc = normalizeImagePath(photoData.src);
                    photoWrapper.style.setProperty('--photo-src', `url('${normalizedSrc}')`);

                    const tapeLeft = document.createElement('span');
                    tapeLeft.className = 'polaroid-tape left';

                    const tapeRight = document.createElement('span');
                    tapeRight.className = 'polaroid-tape right';
                    
                    const img = document.createElement('img');
                    img.src = normalizedSrc;
                    img.alt = monthNames[i];
                    img.loading = 'lazy';

                    const caption = document.createElement('div');
                    caption.className = 'polaroid-caption';
                    caption.textContent = monthNames[i];
                    
                    // Add click handler to open lightbox
                    photoWrapper.addEventListener('click', () => {
                        openLightbox(i, photoIndex);
                    });
                    
                    photoWrapper.appendChild(tapeLeft);
                    photoWrapper.appendChild(tapeRight);
                    photoWrapper.appendChild(img);
                    photoWrapper.appendChild(caption);
                    galleryDiv.appendChild(photoWrapper);
                });
                
                slideDiv.appendChild(galleryDiv);
                slideshowContainer.appendChild(slideDiv);
            }
            
            // Re-add envelope slide (February 2026 - now slide 11)
            if (envelopeSlide) slideshowContainer.appendChild(envelopeSlide);
            
            // Refresh slides query to include newly generated slides
            slides = document.querySelectorAll('.slide');
        }

        function startClosingCarousel(imagePool) {
            const carousel = document.querySelector('.closing-carousel');
            if (!carousel) return;

            const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)');
            if (prefersReducedMotion.matches) return;

            const pool = normalizeImagePool(imagePool);

            const shuffle = (list) => {
                const copy = list.slice();
                for (let i = copy.length - 1; i > 0; i -= 1) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [copy[i], copy[j]] = [copy[j], copy[i]];
                }
                return copy;
            };

            const buildRow = (direction) => {
                const row = document.createElement('div');
                row.className = `closing-carousel-row ${direction}`.trim();

                const track = document.createElement('div');
                track.className = 'closing-carousel-track';

                const picks = shuffle(pool);
                const images = picks.concat(picks);
                images.forEach((src) => {
                    const item = document.createElement('div');
                    item.className = 'closing-carousel-item';
                    const img = document.createElement('img');
                    img.src = src;
                    img.alt = 'Memory photo';
                    item.appendChild(img);
                    track.appendChild(item);
                });

                row.appendChild(track);
                return row;
            };

            carousel.appendChild(buildRow('left'));
            carousel.appendChild(buildRow('right'));
            carousel.appendChild(buildRow('left'));
            carousel.appendChild(buildRow('right'));
        }

        /* ========================================
           LETTER INTERACTION
           Opens/closes the envelope and letter
           ======================================== */
        
        /**
         * Toggles the letter overlay open/closed
         * When opened: Shows letter, blocks navigation
         * When closed: Hides letter, advances to final slide
         */
        function toggleLetter() {
            // Get all the elements we need to manipulate
            const letterOverlay = document.getElementById('letterOverlay');
            const envelope = document.getElementById('envelope');
            const closingOverlay = document.getElementById('closingOverlay');
            const navArrows = document.querySelectorAll('.nav-arrow');
            const timelineSlider = document.querySelector('.timeline-slider');
            
            // Check if letter is currently open
            if (letterOverlay.classList.contains('active')) {
                // === CLOSING THE LETTER ===
                letterOverlay.classList.remove('revealed');  // Hide letter content
                letterOverlay.classList.remove('active');     // Hide overlay
                envelope.classList.remove('opened');          // Close envelope flap
                
                // After letter closes (500ms), show the final closing overlay
                setTimeout(() => {
                    closingOverlay.classList.remove('hidden');
                    closingOverlay.classList.add('active');
                }, 500);
                
                // Re-enable navigation (letter no longer blocking)
                navArrows.forEach(arrow => arrow.classList.remove('disabled'));
                timelineSlider.classList.remove('disabled');
            } else {
                // === OPENING THE LETTER ===
                letterOverlay.classList.add('active');    // Show overlay
                letterOverlay.classList.remove('revealed'); // Hide content initially
                envelope.classList.add('opened');         // Open envelope flap animation
                
                // Disable all navigation while letter is open
                navArrows.forEach(arrow => arrow.classList.add('disabled'));
                timelineSlider.classList.add('disabled');

                // Wait for envelope flap to finish opening (1200ms), then reveal letter content
                setTimeout(() => {
                    letterOverlay.classList.add('revealed');  // Fade in the letter text
                }, 1200);  // Must match envelope flap animation duration
            }
        }

        /**
         * Restarts the entire journey
         * Returns to the intro screen with a smooth fade transition
         * Called by restart button and replay button on final screen
         */
        function restartJourney() {
            // Fade overlay when restarting for smooth transition
            const overlay = document.getElementById('transitionOverlay');
            if (overlay) overlay.style.opacity = '1';
            // Return to intro
            setTimeout(() => {
                const introOverlay = document.getElementById('introOverlay');
                const closingOverlay = document.getElementById('closingOverlay');
                const letterOverlay = document.getElementById('letterOverlay');
                
                introOverlay.classList.remove('exit', 'hidden');
                closingOverlay.classList.remove('active');
                letterOverlay.classList.remove('active', 'revealed');
                showingIntro = true;
                
                // Hide all slides
                slides.forEach((slide) => {
                    slide.classList.remove('active', 'slide-in-right', 'slide-out-left', 'slide-out-right', 'fade-in', 'fade-out');
                });
                
                if (overlay) overlay.style.opacity = '0';
            }, 500);
        }


        /* ========================================
           INITIALIZATION ON PAGE LOAD
           Set up initial state of the page
           ======================================== */
        
        // Get references to main overlays
        const introOverlay = document.getElementById('introOverlay');
        const closingOverlay = document.getElementById('closingOverlay');
        const letterOverlay = document.getElementById('letterOverlay');
        
        // Set initial visibility: Show intro, hide everything else
        if (introOverlay) {
            introOverlay.classList.remove('hidden');  // Show intro
        }
        if (closingOverlay) {
            closingOverlay.classList.add('hidden');   // Hide closing page
        }
        if (letterOverlay) {
            letterOverlay.classList.remove('active', 'revealed');  // Hide letter
        }
        currentSlide = -1;  // Not on any slide yet (intro is showing)

        /* ========================================
           VALENTINE'S DAY TIMELOCK INITIALIZATION
           Validates internet time before allowing access
           ======================================== */
        
        // Initialize timelock on page load
        // This validates server time and location before unlocking the app
        window.addEventListener('load', function() {
            console.log('üîí Initializing Valentine\'s Day timelock...');
            initializeTimelock();
        });
        
        // Unlock function for development (console only)
        // Use: window.bypassTimelock() in browser console to skip validation
        window.bypassTimelock = function() {
            const lockOverlay = document.getElementById('lockOverlay');
            if (lockOverlay) {
                lockOverlay.classList.add('hidden');
                console.log('‚úÖ Timelock bypassed for development.');
            }
        };

        console.log('üîí Valentine\'s Day Timelock Active');
        console.log('Validating internet time and location...');
        console.log('To bypass for development, run: window.bypassTimelock()');
        
        /* ========================================
           END OF JAVASCRIPT
           All interactive functionality complete!
           ======================================== */
    </script>
</body>
</html>